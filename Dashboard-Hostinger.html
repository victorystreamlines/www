<!--
HOSTINGER DATABASE CONTROL PANEL
LAYOUT: sidebar
THEME: gradient-sunset
CSS_FRAMEWORK: tailwind
LANGUAGE: english
SERVER: Hostinger (Shared/VPS)
DATABASE_OPERATIONS: Manage Hostinger database connections
TABLE_OPERATIONS: list_tables, create_table, edit_table, delete_table, rename_table
PHASE: Hostinger Edition
-->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hostinger Database Control Panel</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3a8a 0%, #991b1b 100%);
            min-height: 100vh;
            color: #fef3c7;
        }

        /* Sidebar Navigation */
        .sidebar {
            position: fixed;
            left: 0;
            top: 0;
            width: 260px;
            height: 100vh;
            background: rgba(0, 0, 0, 0.3);
            -webkit-backdrop-filter: blur(10px);
            backdrop-filter: blur(10px);
            padding: 20px;
            transition: transform 0.3s ease;
            z-index: 1000;
            border-right: 1px solid rgba(251, 191, 36, 0.2);
        }

        .sidebar.collapsed {
            transform: translateX(-260px);
        }

        .sidebar-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(251, 191, 36, 0.3);
        }

        .sidebar-title {
            font-size: 20px;
            font-weight: bold;
            color: #fbbf24;
        }

        .sidebar-toggle {
            background: none;
            border: none;
            color: #fbbf24;
            cursor: pointer;
            font-size: 20px;
            padding: 5px;
        }

        .nav-menu {
            list-style: none;
        }

        .nav-item {
            margin-bottom: 10px;
        }

        .nav-link {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            color: #fef3c7;
            text-decoration: none;
            border-radius: 8px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .nav-link:hover {
            background: rgba(251, 191, 36, 0.2);
            color: #fbbf24;
            transform: translateX(5px);
        }

        .nav-link.active {
            background: rgba(251, 191, 36, 0.3);
            color: #fbbf24;
            border-left: 3px solid #f59e0b;
        }

        .nav-icon {
            margin-right: 10px;
            font-size: 18px;
        }

        /* Main Content Area */
        .main-content {
            margin-left: 260px;
            padding: 30px;
            transition: margin-left 0.3s ease;
            min-height: 100vh;
        }

        .main-content.expanded {
            margin-left: 0;
        }

        .content-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .page-title {
            font-size: 32px;
            font-weight: bold;
            color: #fbbf24;
        }

        .toggle-sidebar-btn {
            display: none;
            background: rgba(251, 191, 36, 0.2);
            border: 1px solid #fbbf24;
            color: #fbbf24;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .toggle-sidebar-btn:hover {
            background: rgba(251, 191, 36, 0.3);
        }

        /* Cards */
        .card {
            background: rgba(255, 255, 255, 0.1);
            -webkit-backdrop-filter: blur(10px);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
            border: 1px solid rgba(251, 191, 36, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
        }

        .card-title {
            font-size: 20px;
            font-weight: bold;
            color: #fbbf24;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
        }

        .card-title-icon {
            margin-right: 10px;
        }

        /* Forms */
        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            color: #fef3c7;
            font-weight: 500;
        }

        .form-input, .form-select {
            width: 100%;
            padding: 12px 15px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(251, 191, 36, 0.3);
            border-radius: 8px;
            color: #fef3c7;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .form-input:focus, .form-select:focus {
            outline: none;
            border-color: #fbbf24;
            background: rgba(255, 255, 255, 0.15);
        }

        .form-input::placeholder {
            color: rgba(254, 243, 199, 0.5);
        }

        /* Buttons */
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: #fbbf24;
            color: #1e3a8a;
        }

        .btn-primary:hover {
            background: #f59e0b;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(251, 191, 36, 0.4);
        }

        .btn-danger {
            background: #dc2626;
            color: white;
        }

        .btn-danger:hover {
            background: #b91c1c;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(220, 38, 38, 0.4);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: #fef3c7;
            border: 1px solid rgba(251, 191, 36, 0.3);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        /* Database List */
        .database-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        /* Database Card - Vertical Flex (3 Rows) */
        .database-item {
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(251, 191, 36, 0.2);
            border-radius: 10px;
            padding: 20px;
            transition: all 0.3s ease;
            position: relative;
            display: flex;
            flex-direction: column;
            gap: 15px;
            min-height: 280px;
            cursor: pointer;
        }

        .database-item:hover {
            background: rgba(251, 191, 36, 0.15);
            border-color: #fbbf24;
            transform: translateY(-3px);
            box-shadow: 0 5px 20px rgba(251, 191, 36, 0.3);
        }

        /* Row 1: Logo/Icon (Centered) */
        .database-icon-row {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid rgba(251, 191, 36, 0.15);
        }

        .database-icon {
            font-size: 48px;
        }

        /* Row 2: Text Content (Connection Name, Database, Host) */
        .database-text-row {
            display: flex;
            flex-direction: column;
            gap: 10px;
            flex: 1;
            padding: 10px 0;
        }

        .database-name {
            font-size: 18px;
            font-weight: bold;
            color: #fbbf24;
            text-align: center;
            word-wrap: break-word;
            overflow-wrap: break-word;
            margin-bottom: 8px;
        }

        .database-info-item {
            font-size: 13px;
            color: rgba(254, 243, 199, 0.8);
            text-align: center;
            word-wrap: break-word;
            overflow-wrap: break-word;
            font-family: monospace;
        }

        /* Row 3: Status + Button */
        .database-actions-row {
            display: flex;
            flex-direction: column;
            gap: 10px;
            padding-top: 10px;
            border-top: 1px solid rgba(251, 191, 36, 0.15);
        }

        .database-status {
            padding: 10px;
            border-radius: 6px;
            font-size: 12px;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            min-height: 40px;
        }

        .database-status.testing {
            background: rgba(59, 130, 246, 0.2);
            border: 1px solid #3b82f6;
            color: #93c5fd;
        }

        .database-status.success {
            background: rgba(34, 197, 94, 0.2);
            border: 1px solid #22c55e;
            color: #86efac;
        }

        .database-status.error {
            background: rgba(239, 68, 68, 0.2);
            border: 1px solid #ef4444;
            color: #fca5a5;
        }

        .database-button {
            width: 100%;
            padding: 10px;
            font-size: 13px;
        }

        .lock-icon {
            position: absolute;
            top: 10px;
            right: 10px;
            color: #fbbf24;
            font-size: 16px;
        }

        /* Messages */
        .message {
            padding: 15px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: none;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .message.success {
            background: rgba(34, 197, 94, 0.2);
            border: 1px solid #22c55e;
            color: #86efac;
        }

        .message.error {
            background: rgba(239, 68, 68, 0.2);
            border: 1px solid #ef4444;
            color: #fca5a5;
        }

        .message.info {
            background: rgba(59, 130, 246, 0.2);
            border: 1px solid #3b82f6;
            color: #93c5fd;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            -webkit-backdrop-filter: blur(5px);
            backdrop-filter: blur(5px);
            z-index: 2000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: linear-gradient(135deg, rgba(30, 58, 138, 0.95) 0%, rgba(153, 27, 27, 0.95) 100%);
            border: 1px solid rgba(251, 191, 36, 0.3);
            border-radius: 12px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-title {
            font-size: 22px;
            font-weight: bold;
            color: #fbbf24;
        }

        .modal-close {
            background: none;
            border: none;
            color: #fef3c7;
            font-size: 24px;
            cursor: pointer;
            padding: 0;
            width: 30px;
            height: 30px;
        }

        .modal-close:hover {
            color: #fbbf24;
        }

        .modal-body {
            margin-bottom: 20px;
        }

        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        /* Loading Spinner */
        .spinner {
            border: 3px solid rgba(251, 191, 36, 0.3);
            border-top: 3px solid #fbbf24;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
            display: inline-block;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Expandable Section */
        .expandable-section {
            margin-top: 15px;
        }

        .expandable-header {
            cursor: pointer;
            padding: 10px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: all 0.3s ease;
        }

        .expandable-header:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .expandable-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .expandable-content.expanded {
            max-height: 500px;
            margin-top: 15px;
        }

        .helper-text {
            font-size: 12px;
            color: rgba(254, 243, 199, 0.7);
            margin-top: 5px;
        }

        .security-notice {
            background: rgba(245, 158, 11, 0.2);
            border: 1px solid #f59e0b;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            font-size: 13px;
        }

        .section {
            display: none;
        }

        .section.active {
            display: block;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-260px);
            }

            .sidebar.show {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
            }

            .toggle-sidebar-btn {
                display: block;
            }

            .database-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Datalist styling hint */
        .datalist-wrapper {
            position: relative;
        }

        .saved-credentials-badge {
            display: inline-block;
            background: rgba(34, 197, 94, 0.2);
            color: #86efac;
            font-size: 11px;
            padding: 2px 8px;
            border-radius: 4px;
            margin-left: 10px;
        }

        /* Table Operations Styles */
        .connection-status {
            background: rgba(34, 197, 94, 0.2);
            border: 1px solid #22c55e;
            color: #86efac;
            padding: 12px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: none;
            font-weight: 500;
        }

        .connection-status.active {
            display: block;
        }

        .column-builder {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(251, 191, 36, 0.2);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .column-row {
            display: grid;
            grid-template-columns: 2fr 2fr 1fr 1fr 1fr auto;
            gap: 10px;
            margin-bottom: 10px;
            align-items: end;
        }

        .column-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin-top: 10px;
            padding: 10px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 6px;
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .checkbox-group input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        .checkbox-group label {
            margin: 0;
            cursor: pointer;
            color: #fef3c7;
            font-size: 13px;
        }

        .btn-icon {
            width: 40px;
            height: 40px;
            padding: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
        }

        .sql-preview {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(251, 191, 36, 0.2);
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            color: #86efac;
            white-space: pre-wrap;
            word-break: break-all;
            max-height: 300px;
            overflow-y: auto;
        }

        .template-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }

        .template-card {
            background: rgba(255, 255, 255, 0.08);
            border: 2px solid rgba(251, 191, 36, 0.2);
            border-radius: 8px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .template-card:hover {
            border-color: #fbbf24;
            background: rgba(251, 191, 36, 0.15);
            transform: translateY(-3px);
        }

        .template-card.selected {
            border-color: #fbbf24;
            background: rgba(251, 191, 36, 0.2);
        }

        .template-icon {
            font-size: 32px;
            margin-bottom: 10px;
        }

        .template-name {
            font-weight: bold;
            color: #fef3c7;
            margin-bottom: 5px;
        }

        .template-desc {
            font-size: 11px;
            color: rgba(254, 243, 199, 0.6);
        }

        .table-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .table-item {
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(251, 191, 36, 0.2);
            border-radius: 10px;
            padding: 20px;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .table-item:hover {
            background: rgba(251, 191, 36, 0.15);
            border-color: #fbbf24;
            transform: translateY(-3px);
            box-shadow: 0 5px 20px rgba(251, 191, 36, 0.3);
        }

        .table-actions {
            display: flex;
            gap: 8px;
            padding-top: 10px;
            border-top: 1px solid rgba(251, 191, 36, 0.15);
        }

        .table-actions .btn {
            flex: 1;
            padding: 8px 12px;
            font-size: 12px;
            white-space: nowrap;
        }

        .table-actions .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .table-name {
            font-size: 16px;
            font-weight: bold;
            color: #fef3c7;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .table-icon {
            font-size: 24px;
        }

        /* Tab styles for create table */
        .tab-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 2px solid rgba(251, 191, 36, 0.2);
        }

        .tab-btn {
            background: none;
            border: none;
            color: #fef3c7;
            padding: 12px 24px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
            font-size: 14px;
            font-weight: 500;
        }

        .tab-btn:hover {
            color: #fbbf24;
        }

        .tab-btn.active {
            color: #fbbf24;
            border-bottom-color: #fbbf24;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        @media (max-width: 768px) {
            .column-row {
                grid-template-columns: 1fr;
            }

            .template-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Hidden sections - for temporary hiding */
        .hidden-section {
            display: none !important;
        }

        /* Table Data Viewer Styles */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin: 0;
            font-size: 13px;
        }

        .data-table thead {
            background: rgba(251, 191, 36, 0.2);
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .data-table th {
            padding: 12px 15px;
            text-align: left;
            color: #fbbf24;
            font-weight: bold;
            border-bottom: 2px solid rgba(251, 191, 36, 0.3);
            white-space: nowrap;
        }

        .data-table td {
            padding: 10px 15px;
            color: #fef3c7;
            border-bottom: 1px solid rgba(251, 191, 36, 0.1);
            word-wrap: break-word;
            max-width: 300px;
        }

        .data-table tbody tr {
            transition: all 0.2s ease;
        }

        .data-table tbody tr:hover {
            background: rgba(251, 191, 36, 0.1);
        }

        .data-table tbody tr:nth-child(even) {
            background: rgba(255, 255, 255, 0.02);
        }

        .data-table tbody tr:nth-child(even):hover {
            background: rgba(251, 191, 36, 0.1);
        }

        .stat-box {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid rgba(251, 191, 36, 0.2);
            transition: all 0.3s ease;
        }

        .stat-box:hover {
            background: rgba(251, 191, 36, 0.1);
            border-color: #fbbf24;
        }

        .stat-label {
            font-size: 12px;
            color: rgba(254, 243, 199, 0.7);
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 18px;
            color: #fbbf24;
            font-weight: bold;
        }

        .pagination-info {
            color: rgba(254, 243, 199, 0.8);
            font-size: 14px;
        }

        .pagination-buttons {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .page-input {
            width: 60px;
            padding: 8px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(251, 191, 36, 0.3);
            border-radius: 6px;
            color: #fef3c7;
            text-align: center;
        }

        /* SQL Modal specific styles */
        #sqlCode {
            scrollbar-width: thin;
            scrollbar-color: rgba(251, 191, 36, 0.5) rgba(0, 0, 0, 0.3);
        }

        #sqlCode::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }

        #sqlCode::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 5px;
        }

        #sqlCode::-webkit-scrollbar-thumb {
            background: rgba(251, 191, 36, 0.5);
            border-radius: 5px;
        }

        #sqlCode::-webkit-scrollbar-thumb:hover {
            background: rgba(251, 191, 36, 0.7);
        }

        /* Selected database card - Shiny/Glowing effect */
        .database-item.selected {
            background: linear-gradient(135deg, rgba(251, 191, 36, 0.25) 0%, rgba(245, 158, 11, 0.25) 100%);
            border: 2px solid #fbbf24;
            box-shadow: 0 0 30px rgba(251, 191, 36, 0.6), 0 8px 40px rgba(251, 191, 36, 0.4);
            transform: translateY(-5px) scale(1.02);
        }

        .database-item.selected .database-icon {
            animation: glow-pulse 2s ease-in-out infinite;
        }

        @keyframes glow-pulse {
            0%, 100% {
                filter: drop-shadow(0 0 8px rgba(251, 191, 36, 0.8));
            }
            50% {
                filter: drop-shadow(0 0 20px rgba(251, 191, 36, 1));
            }
        }

        /* Deselect button */
        .deselect-btn {
            display: none;
            background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%);
            color: white;
            border: 1px solid #ef4444;
            padding: 8px 20px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(220, 38, 38, 0.3);
        }

        .deselect-btn:hover {
            background: linear-gradient(135deg, #b91c1c 0%, #7f1d1d 100%);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(220, 38, 38, 0.5);
        }

        .deselect-btn.active {
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        /* Card header with button */
        .card-header-with-action {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        /* Selected Database Badge in Sidebar */
        .selected-db-badge {
            background: linear-gradient(135deg, rgba(251, 191, 36, 0.25) 0%, rgba(245, 158, 11, 0.3) 100%);
            border: 2px solid #fbbf24;
            border-radius: 10px;
            padding: 12px;
            display: flex;
            align-items: center;
            gap: 12px;
            box-shadow: 0 0 20px rgba(251, 191, 36, 0.5), 0 4px 15px rgba(251, 191, 36, 0.3);
            animation: pulse-glow 2s ease-in-out infinite;
            position: relative;
            overflow: hidden;
        }

        .selected-db-badge::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            animation: shine 3s linear infinite;
        }

        @keyframes pulse-glow {
            0%, 100% {
                box-shadow: 0 0 20px rgba(251, 191, 36, 0.5), 0 4px 15px rgba(251, 191, 36, 0.3);
            }
            50% {
                box-shadow: 0 0 30px rgba(251, 191, 36, 0.8), 0 6px 25px rgba(251, 191, 36, 0.5);
            }
        }

        @keyframes shine {
            0% {
                transform: translateX(-100%) translateY(-100%) rotate(45deg);
            }
            100% {
                transform: translateX(100%) translateY(100%) rotate(45deg);
            }
        }

        .selected-db-icon {
            font-size: 28px;
            animation: rotate-sparkle 4s linear infinite;
            filter: drop-shadow(0 0 8px rgba(251, 191, 36, 0.8));
            flex-shrink: 0;
        }

        @keyframes rotate-sparkle {
            0%, 100% {
                transform: rotate(0deg) scale(1);
            }
            25% {
                transform: rotate(10deg) scale(1.1);
            }
            50% {
                transform: rotate(0deg) scale(1);
            }
            75% {
                transform: rotate(-10deg) scale(1.1);
            }
        }

        .selected-db-content {
            flex: 1;
            position: relative;
            z-index: 1;
        }

        .selected-db-label {
            font-size: 11px;
            color: rgba(254, 243, 199, 0.8);
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 4px;
        }

        .selected-db-name {
            font-size: 14px;
            color: #fbbf24;
            font-weight: bold;
            word-wrap: break-word;
            overflow-wrap: break-word;
            line-height: 1.3;
            text-shadow: 0 0 10px rgba(251, 191, 36, 0.5);
        }
    </style>
</head>
<body>
    <!-- Sidebar Navigation -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="sidebar-title">üåê Hostinger DB</div>
            <button class="sidebar-toggle" onclick="toggleSidebar()">‚ò∞</button>
        </div>
        <ul class="nav-menu">
            <li class="nav-item">
                <a class="nav-link active" onclick="showSection('dashboard')">
                    <span class="nav-icon">üìä</span>
                    <span>Dashboard</span>
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" onclick="showSection('list')">
                    <span class="nav-icon">üìã</span>
                    <span>List Databases</span>
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" onclick="showSection('create')">
                    <span class="nav-icon">‚ûï</span>
                    <span>Create Database</span>
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" onclick="showSection('delete')">
                    <span class="nav-icon">üóëÔ∏è</span>
                    <span>Delete Database</span>
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" onclick="showSection('rename')">
                    <span class="nav-icon">‚úèÔ∏è</span>
                    <span>Rename Database</span>
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" onclick="showSection('credentials')">
                    <span class="nav-icon">üîê</span>
                    <span>Set Credentials</span>
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" onclick="showSection('settings')">
                    <span class="nav-icon">‚öôÔ∏è</span>
                    <span>Hostinger Connections</span>
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" onclick="showSection('generateDatabase')">
                    <span class="nav-icon">üóÑÔ∏è</span>
                    <span>Generate Database SQL</span>
                </a>
            </li>
            <!-- TABLE OPERATIONS - HIDDEN -->
            <li class="nav-item hidden-section" style="margin-top: 20px; padding-top: 20px; border-top: 1px solid rgba(251, 191, 36, 0.3);">
                <div style="color: rgba(251, 191, 36, 0.7); font-size: 12px; padding: 0 15px; margin-bottom: 10px;">TABLE OPERATIONS</div>
            </li>
            <!-- Selected Database Alert -->
            <li id="selectedDatabaseAlert" class="nav-item hidden-section" style="padding: 0 10px; margin-bottom: 15px;">
                <div class="selected-db-badge">
                    <div class="selected-db-icon">‚ú®</div>
                    <div class="selected-db-content">
                        <div class="selected-db-label">Database Selected</div>
                        <div id="selectedDatabaseName" class="selected-db-name">Database Name</div>
                    </div>
                </div>
            </li>
            <li class="nav-item hidden-section">
                <a class="nav-link" onclick="showSection('listTables')">
                    <span class="nav-icon">üìÑ</span>
                    <span>List Tables</span>
                </a>
            </li>
            <li class="nav-item hidden-section">
                <a class="nav-link" onclick="showSection('createTable')">
                    <span class="nav-icon">‚ûï</span>
                    <span>Create Table</span>
                </a>
            </li>
            <li class="nav-item hidden-section">
                <a class="nav-link" onclick="showSection('editTable')">
                    <span class="nav-icon">‚úèÔ∏è</span>
                    <span>Edit Table</span>
                </a>
            </li>
            <li class="nav-item hidden-section">
                <a class="nav-link" onclick="showSection('deleteTable')">
                    <span class="nav-icon">üóëÔ∏è</span>
                    <span>Delete Table</span>
                </a>
            </li>
            <li class="nav-item hidden-section">
                <a class="nav-link" onclick="showSection('renameTable')">
                    <span class="nav-icon">‚úèÔ∏è</span>
                    <span>Rename Table</span>
                </a>
            </li>
        </ul>
    </aside>

    <!-- Main Content -->
    <main class="main-content" id="mainContent">
        <div class="content-header">
            <h1 class="page-title">Hostinger Database Control Panel</h1>
            <button class="toggle-sidebar-btn" onclick="toggleSidebar()">‚ò∞ Menu</button>
        </div>

        <!-- Dashboard Section -->
        <section id="dashboard" class="section active">
            <div class="card">
                <div class="card-header-with-action">
                    <h2 class="card-title" style="margin-bottom: 0;">
                        <span class="card-title-icon">üåê</span>
                        Configured Hostinger Connections
                    </h2>
                    <button id="deselectDatabaseBtn" class="deselect-btn" onclick="deselectAllDatabases()">
                        <span>‚úñÔ∏è</span>
                        <span>Deselect Database</span>
                    </button>
                </div>
                <div id="dashboardMessage"></div>
                <div id="configuredConnectionsList" class="database-grid" style="margin-top: 20px;">
                    <p style="color: rgba(254, 243, 199, 0.6); text-align: center; padding: 40px;">
                        No Hostinger connections configured.<br>
                        <span style="font-size: 14px;">Go to <strong>Hostinger Connections</strong> in the sidebar to add your first connection.</span>
                    </p>
                </div>
            </div>

            <div class="card">
                <h2 class="card-title">
                    <span class="card-title-icon">üíª</span>
                    Your PC Information
                </h2>
                <div style="background: rgba(59, 130, 246, 0.1); padding: 15px; border-radius: 8px; border: 1px solid rgba(59, 130, 246, 0.3); margin-bottom: 15px;">
                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                        <span style="font-size: 24px;">üñ•Ô∏è</span>
                        <div>
                            <strong style="color: #fbbf24; font-size: 16px;">Your PC IP Address:</strong>
                            <div style="font-family: monospace; font-size: 18px; color: #3b82f6; margin-top: 5px;">192.168.8.4</div>
                        </div>
                    </div>
                    <div style="font-size: 13px; color: rgba(254, 243, 199, 0.7);">
                        üí° Use this IP when connecting to databases on your local network or for external access to your PC's MySQL server
                    </div>
                </div>
            </div>

            <div class="card">
                <h2 class="card-title">
                    <span class="card-title-icon">üìä</span>
                    Quick Guide
                </h2>
                <p>Welcome to the Hostinger Database Control Panel. Manage your Hostinger databases (Shared Hosting or VPS).</p>
                <ul style="margin-top: 15px; line-height: 1.8;">
                    <li>‚úÖ Add multiple Hostinger database connections</li>
                    <li>‚úÖ Test connection status for each database</li>
                    <li>‚úÖ Manage tables, create, edit, delete operations</li>
                    <li>‚úÖ Supports both Shared Hosting and VPS databases</li>
                    <li>‚úÖ All credentials stored locally in your browser</li>
                </ul>
            </div>
        </section>

        <!-- List Databases Section -->
        <section id="list" class="section">
            <div class="card">
                <h2 class="card-title">
                    <span class="card-title-icon">üìã</span>
                    Available Databases
                </h2>
                <div id="listMessage"></div>
                <button class="btn btn-primary" onclick="loadDatabases()">
                    <span>üîÑ</span> Refresh List
                </button>
                <div id="databaseList" class="database-grid"></div>
            </div>
        </section>

        <!-- Create Database Section -->
        <section id="create" class="section">
            <div class="card">
                <h2 class="card-title">
                    <span class="card-title-icon">‚ûï</span>
                    Create New Database
                </h2>
                <div id="createMessage"></div>
                <form onsubmit="createDatabase(event)">
                    <div class="form-group">
                        <label class="form-label">Database Name *</label>
                        <input type="text" id="newDbName" class="form-input" placeholder="Enter database name" required>
                        <div class="helper-text">Use alphanumeric characters and underscores only</div>
                    </div>

                    <div class="expandable-section">
                        <div class="expandable-header" onclick="toggleExpandable('createCredentials')">
                            <span>üîê Set Database Credentials (Optional)</span>
                            <span id="createCredentialsToggle">‚ñº</span>
                        </div>
                        <div id="createCredentials" class="expandable-content">
                            <div class="helper-text" style="margin-bottom: 15px;">
                                Set specific username/password for this database (optional). Leave empty to use default credentials. Credentials will be saved for future use.
                            </div>
                            <div class="form-group">
                                <label class="form-label">Database Username</label>
                                <input type="text" id="newDbUsername" class="form-input" placeholder="Enter username (optional)">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Database Password</label>
                                <input type="password" id="newDbPassword" class="form-input" placeholder="Enter password (optional)">
                            </div>
                        </div>
                    </div>

                    <button type="submit" class="btn btn-primary">
                        <span>‚ûï</span> Create Database
                    </button>
                </form>
            </div>
        </section>

        <!-- Delete Database Section -->
        <section id="delete" class="section">
            <div class="card">
                <h2 class="card-title">
                    <span class="card-title-icon">üóëÔ∏è</span>
                    Delete Database
                </h2>
                <div id="deleteMessage"></div>
                <form onsubmit="deleteDatabase(event)">
                    <div class="form-group">
                        <label class="form-label">Select Database to Delete *</label>
                        <select id="deleteDbSelect" class="form-select" required>
                            <option value="">-- Select Database --</option>
                        </select>
                        <div class="helper-text">‚ö†Ô∏è This action cannot be undone!</div>
                    </div>
                    <button type="submit" class="btn btn-danger">
                        <span>üóëÔ∏è</span> Delete Database
                    </button>
                </form>
            </div>
        </section>

        <!-- Rename Database Section -->
        <section id="rename" class="section">
            <div class="card">
                <h2 class="card-title">
                    <span class="card-title-icon">‚úèÔ∏è</span>
                    Rename Database
                </h2>
                <div id="renameMessage"></div>
                <form onsubmit="renameDatabase(event)">
                    <div class="form-group">
                        <label class="form-label">Select Database to Rename *</label>
                        <select id="renameOldSelect" class="form-select" required>
                            <option value="">-- Select Database --</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">New Database Name *</label>
                        <input type="text" id="renameNewName" class="form-input" placeholder="Enter new name" required>
                        <div class="helper-text">Use alphanumeric characters and underscores only</div>
                    </div>
                    <button type="submit" class="btn btn-primary">
                        <span>‚úèÔ∏è</span> Rename Database
                    </button>
                </form>
            </div>
        </section>

        <!-- Set Credentials Section -->
        <section id="credentials" class="section">
            <div class="card">
                <h2 class="card-title">
                    <span class="card-title-icon">üîê</span>
                    Set Database Credentials
                </h2>
                <div id="credentialsMessage"></div>
                <p style="margin-bottom: 20px;">Add username and password authentication to secure your database. This creates a database user with specific credentials.</p>
                <form onsubmit="setDatabaseCredentials(event)">
                    <div class="form-group">
                        <label class="form-label">Select Database *</label>
                        <select id="credentialsDbSelect" class="form-select" required onchange="checkExistingCredentials()">
                            <option value="">-- Select Database --</option>
                        </select>
                    </div>
                    <div id="credentialStatus" style="margin-bottom: 15px;"></div>
                    <div class="form-group">
                        <label class="form-label">Username *</label>
                        <input type="text" id="credentialsUsername" class="form-input" placeholder="Enter username" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Password *</label>
                        <input type="password" id="credentialsPassword" class="form-input" placeholder="Enter password" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Confirm Password *</label>
                        <input type="password" id="credentialsConfirmPassword" class="form-input" placeholder="Confirm password" required>
                    </div>
                    <button type="submit" class="btn btn-primary">
                        <span>üîê</span> Set Credentials
                    </button>
                </form>
            </div>
        </section>

        <!-- Settings Section - Hostinger Connections -->
        <section id="settings" class="section">
            <div class="card">
                <h2 class="card-title">
                    <span class="card-title-icon">‚öôÔ∏è</span>
                    Manage Hostinger Connections
                </h2>
                <div class="security-notice">
                    <strong>üåê Hostinger Database Connections:</strong> Add your Hostinger database credentials (Shared Hosting or VPS). All data is stored locally in your browser's localStorage.
                </div>
                <div id="settingsMessage"></div>

                <!-- Add New Connection Form -->
                <div style="background: rgba(255, 255, 255, 0.05); padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                    <h3 style="color: #fbbf24; margin-bottom: 15px;">‚ûï Add New Connection</h3>
                    <form onsubmit="addHostingerConnection(event)">
                        <div class="form-group">
                            <label class="form-label">Connection Name *</label>
                            <input type="text" id="connName" class="form-input" placeholder="e.g., My VPS, Shared Host 1" required>
                            <div class="helper-text">Give a friendly name to identify this connection</div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Connection Type *</label>
                            <select id="connType" class="form-select" required>
                                <option value="shared">Shared Hosting</option>
                                <option value="vps">VPS</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Database Host *</label>
                            <div style="display: flex; gap: 10px; margin-bottom: 5px;">
                                <button type="button" class="btn btn-secondary" style="padding: 6px 12px; font-size: 12px; flex: 1;" onclick="document.getElementById('connHost').value='192.168.8.4'">üñ•Ô∏è My PC (192.168.8.4)</button>
                                <button type="button" class="btn btn-secondary" style="padding: 6px 12px; font-size: 12px; flex: 1;" onclick="document.getElementById('connHost').value='localhost'">üìç localhost</button>
                                <button type="button" class="btn btn-secondary" style="padding: 6px 12px; font-size: 12px; flex: 1;" onclick="document.getElementById('connHost').value='127.0.0.1'">üîó 127.0.0.1</button>
                            </div>
                            <input type="text" id="connHost" class="form-input" list="hostList" placeholder="e.g., localhost, 192.168.8.4, or Hostinger host" value="192.168.8.4" required>
                            <datalist id="hostList"></datalist>
                            <div class="helper-text">üí° Your PC IP: 192.168.8.4 | Use 'localhost' for shared hosting | Use Hostinger host for remote</div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Database Name *</label>
                            <input type="text" id="connDbName" class="form-input" list="dbNameList" placeholder="Database name" required>
                            <datalist id="dbNameList"></datalist>
                            <div class="helper-text">üí° Select from previous entries or type new name</div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Database Username *</label>
                            <input type="text" id="connUsername" class="form-input" list="usernameList" placeholder="Username" required>
                            <datalist id="usernameList"></datalist>
                            <div class="helper-text">üí° Select from previous entries or type new username</div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Database Password *</label>
                            <div style="position: relative;">
                                <input type="password" id="connPassword" class="form-input" placeholder="Password" required style="padding-right: 45px;">
                                <button type="button" onclick="togglePasswordVisibility()" style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); background: rgba(59, 130, 246, 0.2); border: 1px solid #3b82f6; color: #93c5fd; padding: 6px 10px; border-radius: 6px; cursor: pointer; font-size: 16px; transition: all 0.3s;" id="togglePasswordBtn">
                                    üëÅÔ∏è
                                </button>
                            </div>
                            <div class="helper-text">üí° Click the eye icon to show/hide password</div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Port</label>
                            <input type="text" id="connPort" class="form-input" placeholder="3306" value="3306">
                            <div class="helper-text">Default MySQL port is 3306</div>
                        </div>
                        <button type="submit" class="btn btn-primary">
                            <span>‚ûï</span> Add Connection
                        </button>
                    </form>
                </div>

                <!-- Connections List Table -->
                <div style="margin-top: 30px;">
                    <h3 style="color: #fbbf24; margin-bottom: 15px;">üìã Saved Connections</h3>
                    <div id="hostingerConnectionsTable"></div>
                </div>

                <!-- Export/Import Buttons -->
                <div style="margin-top: 30px; display: flex; gap: 15px; flex-wrap: wrap;">
                    <button class="btn btn-primary" onclick="exportConnectionsToFile()">
                        <span>üì§</span> Export (Save to File)
                    </button>
                    <button class="btn btn-primary" onclick="showImportModal()">
                        <span>üì•</span> Import (Load from File)
                    </button>
                    <button class="btn btn-danger" onclick="clearAllHostingerConnections()">
                        <span>üóëÔ∏è</span> Clear All Connections
                    </button>
                </div>

                <!-- Export/Import Info -->
                <div style="margin-top: 20px; background: rgba(59, 130, 246, 0.1); padding: 15px; border-radius: 8px; border: 1px solid rgba(59, 130, 246, 0.3);">
                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                        <span style="font-size: 24px;">üíæ</span>
                        <div>
                            <strong style="color: #fbbf24; font-size: 16px;">Backup & Restore with File Picker</strong>
                        </div>
                    </div>
                    <div style="font-size: 13px; color: rgba(254, 243, 199, 0.7); line-height: 1.6;">
                        <strong>üì§ Export:</strong> Opens file picker - Choose where to save your backup (JSON file)<br>
                        <strong>üì• Import:</strong> Opens file picker - Select a backup file to restore<br>
                        <strong>üí° Smart Merge:</strong> Import merges with existing connections (no data loss)<br>
                        <strong>üîí Secure:</strong> Files saved on your computer with full control
                    </div>
                </div>
            </div>
        </section>

        <!-- Generate Database SQL Section -->
        <section id="generateDatabase" class="section">
            <div class="card">
                <h2 class="card-title">
                    <span class="card-title-icon">üóÑÔ∏è</span>
                    Generate Database SQL Dump
                </h2>
                <div id="generateDatabaseMessage"></div>
                
                <!-- Selected Database Info -->
                <div id="selectedDbInfo" style="background: rgba(59, 130, 246, 0.1); padding: 15px; border-radius: 8px; border: 1px solid rgba(59, 130, 246, 0.3); margin-bottom: 20px;">
                    <div style="font-size: 14px; color: rgba(254, 243, 199, 0.9);">
                        <strong>üìä Selected Database:</strong> <span id="selectedDbNameDisplay" style="color: #fbbf24; font-weight: bold;">None</span>
                    </div>
                    <div style="font-size: 13px; color: rgba(254, 243, 199, 0.7); margin-top: 5px;">
                        üí° Please select a database from the Dashboard to generate SQL
                    </div>
                </div>

                <!-- Generation Options -->
                <div style="background: rgba(255, 255, 255, 0.05); padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                    <h3 style="color: #fbbf24; margin-bottom: 20px;">üìù SQL Generation Options</h3>
                    
                    <!-- Option 1: Structure Only -->
                    <div style="background: rgba(255, 255, 255, 0.05); border: 2px solid rgba(251, 191, 36, 0.2); border-radius: 10px; padding: 20px; margin-bottom: 15px; transition: all 0.3s;" onmouseover="this.style.borderColor='#fbbf24'; this.style.background='rgba(251, 191, 36, 0.1)';" onmouseout="this.style.borderColor='rgba(251, 191, 36, 0.2)'; this.style.background='rgba(255, 255, 255, 0.05)';">
                        <div style="display: flex; justify-content: space-between; align-items: center; gap: 20px;">
                            <div style="flex: 1;">
                                <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                    <span style="font-size: 32px;">üèóÔ∏è</span>
                                    <div>
                                        <h4 style="color: #fbbf24; margin: 0;">Tables Structure Only</h4>
                                        <p style="margin: 5px 0 0 0; font-size: 13px; color: rgba(254, 243, 199, 0.7);">
                                            Generate CREATE TABLE statements for all tables (no data)<br>
                                            ‚úÖ Perfect for: Injecting into existing database
                                        </p>
                                    </div>
                                </div>
                            </div>
                            <button class="btn btn-primary" onclick="generateDatabaseSQL(false, false)" style="padding: 12px 24px;">
                                <span>üèóÔ∏è</span> Generate
                            </button>
                        </div>
                    </div>

                    <!-- Option 2: Full Database (CREATE DATABASE + Structure) -->
                    <div style="background: rgba(255, 255, 255, 0.05); border: 2px solid rgba(251, 191, 36, 0.2); border-radius: 10px; padding: 20px; margin-bottom: 15px; transition: all 0.3s;" onmouseover="this.style.borderColor='#fbbf24'; this.style.background='rgba(251, 191, 36, 0.1)';" onmouseout="this.style.borderColor='rgba(251, 191, 36, 0.2)'; this.style.background='rgba(255, 255, 255, 0.05)';">
                        <div style="display: flex; justify-content: space-between; align-items: center; gap: 20px;">
                            <div style="flex: 1;">
                                <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                    <span style="font-size: 32px;">üóÑÔ∏è</span>
                                    <div>
                                        <h4 style="color: #fbbf24; margin: 0;">Full Database (CREATE DATABASE + Tables)</h4>
                                        <p style="margin: 5px 0 0 0; font-size: 13px; color: rgba(254, 243, 199, 0.7);">
                                            Generate CREATE DATABASE + all table structures (no data)<br>
                                            ‚úÖ Perfect for: Complete database migration
                                        </p>
                                    </div>
                                </div>
                            </div>
                            <button class="btn btn-primary" onclick="generateDatabaseSQL(true, false)" style="padding: 12px 24px;">
                                <span>üóÑÔ∏è</span> Generate
                            </button>
                        </div>
                    </div>

                    <!-- Option 3: Structure + Data -->
                    <div style="background: rgba(255, 255, 255, 0.05); border: 2px solid rgba(251, 191, 36, 0.2); border-radius: 10px; padding: 20px; margin-bottom: 15px; transition: all 0.3s;" onmouseover="this.style.borderColor='#fbbf24'; this.style.background='rgba(251, 191, 36, 0.1)';" onmouseout="this.style.borderColor='rgba(251, 191, 36, 0.2)'; this.style.background='rgba(255, 255, 255, 0.05)';">
                        <div style="display: flex; justify-content: space-between; align-items: center; gap: 20px;">
                            <div style="flex: 1;">
                                <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                    <span style="font-size: 32px;">üì¶</span>
                                    <div>
                                        <h4 style="color: #fbbf24; margin: 0;">Tables Structure + Data</h4>
                                        <p style="margin: 5px 0 0 0; font-size: 13px; color: rgba(254, 243, 199, 0.7);">
                                            Generate all table structures + INSERT data (no CREATE DATABASE)<br>
                                            ‚úÖ Perfect for: Injecting complete data into existing database
                                        </p>
                                    </div>
                                </div>
                            </div>
                            <button class="btn btn-primary" onclick="generateDatabaseSQL(false, true)" style="padding: 12px 24px;">
                                <span>üì¶</span> Generate
                            </button>
                        </div>
                    </div>

                    <!-- Option 4: Full Database + Data -->
                    <div style="background: rgba(255, 255, 255, 0.05); border: 2px solid rgba(34, 197, 94, 0.2); border-radius: 10px; padding: 20px; transition: all 0.3s;" onmouseover="this.style.borderColor='#22c55e'; this.style.background='rgba(34, 197, 94, 0.1)';" onmouseout="this.style.borderColor='rgba(34, 197, 94, 0.2)'; this.style.background='rgba(255, 255, 255, 0.05)';">
                        <div style="display: flex; justify-content: space-between; align-items: center; gap: 20px;">
                            <div style="flex: 1;">
                                <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                    <span style="font-size: 32px;">üíé</span>
                                    <div>
                                        <h4 style="color: #86efac; margin: 0;">Complete Database Dump (Everything!)</h4>
                                        <p style="margin: 5px 0 0 0; font-size: 13px; color: rgba(254, 243, 199, 0.7);">
                                            Generate CREATE DATABASE + all tables + all data<br>
                                            ‚úÖ Perfect for: Complete backup and restore
                                        </p>
                                    </div>
                                </div>
                            </div>
                            <button class="btn btn-primary" onclick="generateDatabaseSQL(true, true)" style="padding: 12px 24px; background: #22c55e; color: #1e3a8a;">
                                <span>üíé</span> Generate All
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Help Section -->
                <div style="background: rgba(245, 158, 11, 0.1); border: 1px solid #f59e0b; border-radius: 8px; padding: 15px;">
                    <h4 style="color: #fbbf24; margin: 0 0 10px 0;">üí° Quick Tips</h4>
                    <ul style="margin: 0; padding-left: 20px; line-height: 1.8; font-size: 13px; color: rgba(254, 243, 199, 0.8);">
                        <li><strong>Structure Only:</strong> Use when you want to recreate table structure in another database</li>
                        <li><strong>+ CREATE DATABASE:</strong> Use when migrating to new server (with database creation permission)</li>
                        <li><strong>+ Data:</strong> Use for complete backup or migration with all data</li>
                        <li><strong>Complete Dump:</strong> Full backup - includes everything</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- List Tables Section - HIDDEN -->
        <section id="listTables" class="section hidden-section">
            <div id="tableConnectionStatus" class="connection-status"></div>
            
            <!-- Tables List View -->
            <div id="tablesListView" class="card">
                <h2 class="card-title">
                    <span class="card-title-icon">üìÑ</span>
                    Tables in Database
                </h2>
                <div id="listTablesMessage"></div>
                <button class="btn btn-primary" onclick="loadTables()">
                    <span>üîÑ</span> Refresh Tables
                </button>
                <div id="tableList" class="table-grid"></div>
            </div>

            <!-- Table Data View -->
            <div id="tableDataView" class="card" style="display: none;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; flex-wrap: wrap; gap: 15px;">
                    <h2 class="card-title" style="margin: 0;">
                        <span class="card-title-icon">üìä</span>
                        <span id="currentTableName">Table Data</span>
                    </h2>
                    <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                        <button class="btn btn-primary" onclick="injectRandomRecords()" style="background: linear-gradient(135deg, #22c55e 0%, #15803d 100%);">
                            <span>üé≤</span> Inject 10 Random Records
                        </button>
                        <button class="btn btn-primary" onclick="generateSQL(false)">
                            <span>üèóÔ∏è</span> Generate Structure
                        </button>
                        <button class="btn btn-primary" onclick="generateSQL(true)">
                            <span>üì¶</span> Generate Structure + Data
                        </button>
                        <button class="btn btn-secondary" onclick="backToTablesList()">
                            <span>‚¨ÖÔ∏è</span> Back to Tables
                        </button>
                    </div>
                </div>
                
                <!-- Table Info Stats -->
                <div id="tableInfoStats" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;"></div>
                
                <div id="tableDataMessage"></div>
                
                <!-- Pagination Controls (Top) -->
                <div id="paginationTop" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; padding: 15px; background: rgba(255,255,255,0.05); border-radius: 8px;"></div>
                
                <!-- Table Data -->
                <div id="tableDataContainer" style="overflow-x: auto; background: rgba(0,0,0,0.2); border-radius: 8px; padding: 10px;"></div>
                
                <!-- Pagination Controls (Bottom) -->
                <div id="paginationBottom" style="display: flex; justify-content: space-between; align-items: center; margin-top: 15px; padding: 15px; background: rgba(255,255,255,0.05); border-radius: 8px;"></div>
            </div>
        </section>

        <!-- Create Table Section - HIDDEN -->
        <section id="createTable" class="section hidden-section">
            <!-- Selected Database Display -->
            <div style="background: rgba(34, 197, 94, 0.2); border: 1px solid #22c55e; color: #86efac; padding: 12px 20px; border-radius: 8px; margin-bottom: 20px; font-weight: 500;">
                ‚úÖ Creating table in: <strong id="createTableDbName" style="color: #fbbf24;">Database Name</strong>
            </div>
            
            <div class="card">
                <h2 class="card-title">
                    <span class="card-title-icon">‚ûï</span>
                    Create New Table
                </h2>
                <div id="createTableMessage"></div>

                <!-- Tab Navigation -->
                <div class="tab-buttons">
                    <button class="tab-btn active" onclick="switchTab('manual')">Manual Definition</button>
                    <button class="tab-btn" onclick="switchTab('template')">Use Template</button>
                </div>

                <!-- Manual Tab -->
                <div id="manualTab" class="tab-content active">
                    <form onsubmit="createTableManual(event)">
                        <div class="form-group">
                            <label class="form-label">Table Name *</label>
                            <input type="text" id="newTableName" class="form-input" placeholder="Enter table name" required>
                            <div class="helper-text">Use alphanumeric characters and underscores only</div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Table Columns</label>
                            <div id="columnBuilder" class="column-builder"></div>
                            <button type="button" class="btn btn-secondary" onclick="addColumnRow()">
                                <span>‚ûï</span> Add Column
                            </button>
                        </div>

                        <div id="sqlPreview" class="sql-preview" style="display: none;"></div>

                        <div style="display: flex; gap: 10px; margin-top: 20px;">
                            <button type="button" class="btn btn-secondary" onclick="previewSQL()">
                                <span>üëÅÔ∏è</span> Preview SQL
                            </button>
                            <button type="submit" class="btn btn-primary">
                                <span>‚ûï</span> Create Table
                            </button>
                        </div>
                    </form>
                </div>

                <!-- Template Tab -->
                <div id="templateTab" class="tab-content">
                    <form onsubmit="createTableFromTemplate(event)">
                        <div class="form-group">
                            <label class="form-label">Table Name *</label>
                            <input type="text" id="templateTableName" class="form-input" placeholder="Enter table name" required>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Select Template</label>
                            <div class="template-grid" id="templateGrid"></div>
                        </div>

                        <div id="templateColumnBuilder" class="column-builder" style="display: none; margin-top: 20px;">
                            <h4 style="color: #fbbf24; margin-bottom: 15px;">Template Columns (You can modify)</h4>
                            <div id="templateColumns"></div>
                        </div>

                        <div id="templateSqlPreview" class="sql-preview" style="display: none;"></div>

                        <div style="display: flex; gap: 10px; margin-top: 20px;">
                            <button type="button" class="btn btn-secondary" onclick="previewTemplateSQL()">
                                <span>üëÅÔ∏è</span> Preview SQL
                            </button>
                            <button type="submit" class="btn btn-primary">
                                <span>‚ûï</span> Create Table from Template
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </section>

        <!-- Edit Table Section - HIDDEN -->
        <section id="editTable" class="section hidden-section">
            <!-- Selected Database Display -->
            <div style="background: rgba(34, 197, 94, 0.2); border: 1px solid #22c55e; color: #86efac; padding: 12px 20px; border-radius: 8px; margin-bottom: 20px; font-weight: 500;">
                ‚úÖ Editing tables in: <strong id="editTableDbName" style="color: #fbbf24;">Database Name</strong>
            </div>

            <div class="card">
                <h2 class="card-title">
                    <span class="card-title-icon">‚úèÔ∏è</span>
                    Edit Table Structure
                </h2>
                <div id="editTableMessage"></div>
                
                <div class="form-group">
                    <label class="form-label">Select Table *</label>
                    <select id="editTableSelect" class="form-select" onchange="loadTableStructure()" required>
                        <option value="">-- Select Table --</option>
                    </select>
                    <div class="helper-text" id="editTableHelper">üí° Select a database from Dashboard to see available tables</div>
                </div>

                <div id="currentStructure" style="display: none;">
                    <h3 style="color: #fbbf24; margin: 20px 0 10px;">Current Columns</h3>
                    <div id="currentColumns"></div>

                    <h3 style="color: #fbbf24; margin: 20px 0 10px;">Add New Column</h3>
                    <div class="column-builder">
                        <div class="column-row">
                            <div class="form-group" style="margin: 0;">
                                <input type="text" id="newColName" class="form-input" placeholder="Column name">
                            </div>
                            <div class="form-group" style="margin: 0;">
                                <select id="newColType" class="form-select">
                                    <option value="INT">INT</option>
                                    <option value="VARCHAR">VARCHAR</option>
                                    <option value="TEXT">TEXT</option>
                                    <option value="DATE">DATE</option>
                                    <option value="DATETIME">DATETIME</option>
                                    <option value="TIMESTAMP">TIMESTAMP</option>
                                    <option value="BOOLEAN">BOOLEAN</option>
                                    <option value="DECIMAL">DECIMAL</option>
                                    <option value="FLOAT">FLOAT</option>
                                </select>
                            </div>
                            <div class="form-group" style="margin: 0;">
                                <input type="text" id="newColLength" class="form-input" placeholder="Length">
                            </div>
                            <div class="form-group" style="margin: 0;">
                                <select id="newColNullable" class="form-select">
                                    <option value="yes">NULL</option>
                                    <option value="no">NOT NULL</option>
                                </select>
                            </div>
                            <div class="form-group" style="margin: 0;">
                                <input type="text" id="newColDefault" class="form-input" placeholder="Default">
                            </div>
                            <button type="button" class="btn btn-primary btn-icon" onclick="addColumn()">+</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Delete Table Section - HIDDEN -->
        <section id="deleteTable" class="section hidden-section">
            <!-- Selected Database Display -->
            <div style="background: rgba(34, 197, 94, 0.2); border: 1px solid #22c55e; color: #86efac; padding: 12px 20px; border-radius: 8px; margin-bottom: 20px; font-weight: 500;">
                ‚úÖ Deleting tables from: <strong id="deleteTableDbName" style="color: #fbbf24;">Database Name</strong>
            </div>

            <div class="card">
                <h2 class="card-title">
                    <span class="card-title-icon">üóëÔ∏è</span>
                    Delete Table
                </h2>
                <div id="deleteTableMessage"></div>
                <form onsubmit="deleteTableAction(event)">
                    <div class="form-group">
                        <label class="form-label">Select Table to Delete *</label>
                        <select id="deleteTableSelect" class="form-select" required>
                            <option value="">-- Select Table --</option>
                        </select>
                        <div class="helper-text">‚ö†Ô∏è This action cannot be undone!</div>
                    </div>
                    <button type="submit" class="btn btn-danger">
                        <span>üóëÔ∏è</span> Delete Table
                    </button>
                </form>
            </div>
        </section>

        <!-- Rename Table Section - HIDDEN -->
        <section id="renameTable" class="section hidden-section">
            <!-- Selected Database Display -->
            <div style="background: rgba(34, 197, 94, 0.2); border: 1px solid #22c55e; color: #86efac; padding: 12px 20px; border-radius: 8px; margin-bottom: 20px; font-weight: 500;">
                ‚úÖ Renaming tables in: <strong id="renameTableDbName" style="color: #fbbf24;">Database Name</strong>
            </div>

            <div class="card">
                <h2 class="card-title">
                    <span class="card-title-icon">‚úèÔ∏è</span>
                    Rename Table
                </h2>
                <div id="renameTableMessage"></div>
                <form onsubmit="renameTableAction(event)">
                    <div class="form-group">
                        <label class="form-label">Select Table to Rename *</label>
                        <select id="renameTableOldSelect" class="form-select" required>
                            <option value="">-- Select Table --</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">New Table Name *</label>
                        <input type="text" id="renameTableNewName" class="form-input" placeholder="Enter new name" required>
                        <div class="helper-text">Use alphanumeric characters and underscores only</div>
                    </div>
                    <button type="submit" class="btn btn-primary">
                        <span>‚úèÔ∏è</span> Rename Table
                    </button>
                </form>
            </div>
        </section>
    </main>

    <!-- Connection Modal -->
    <div id="connectionModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="modalTitle">Database Connection</h3>
                <button class="modal-close" onclick="closeConnectionModal()">√ó</button>
            </div>
            <div class="modal-body">
                <div id="modalMessage"></div>
                <div class="form-group">
                    <label class="form-label">Database Username</label>
                    <div class="datalist-wrapper">
                        <input type="text" id="modalUsername" class="form-input" placeholder="Enter username" list="savedUsernames">
                        <datalist id="savedUsernames"></datalist>
                    </div>
                    <div class="helper-text">Select a previously saved username or enter a new one</div>
                </div>
                <div class="form-group">
                    <label class="form-label">Database Password</label>
                    <input type="password" id="modalPassword" class="form-input" placeholder="Enter password">
                </div>
                <div class="helper-text">‚úÖ Credentials will be saved locally for future use</div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeConnectionModal()">Cancel</button>
                <button class="btn btn-primary" onclick="submitConnection()">
                    <span>üîå</span> Connect
                </button>
            </div>
        </div>
    </div>

    <!-- SQL Generator Modal -->
    <div id="sqlModal" class="modal">
        <div class="modal-content" style="max-width: 900px; max-height: 90vh;">
            <div class="modal-header">
                <h3 class="modal-title">
                    <span>üìù</span> Generated SQL for <span id="sqlTableName"></span>
                </h3>
                <button class="modal-close" onclick="closeSQLModal()">√ó</button>
            </div>
            <div class="modal-body" style="max-height: 70vh; overflow: hidden; display: flex; flex-direction: column;">
                <div id="sqlMessage" style="margin-bottom: 15px;"></div>
                
                <!-- SQL Info -->
                <div id="sqlInfo" style="display: flex; gap: 15px; margin-bottom: 15px; flex-wrap: wrap;"></div>
                
                <!-- SQL Code Container -->
                <div style="position: relative; flex: 1; display: flex; flex-direction: column; overflow: hidden;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                        <div style="color: rgba(254, 243, 199, 0.8); font-size: 13px;">üí° Copy the SQL below and run it in any MySQL database</div>
                        <button class="btn btn-primary" onclick="copySQLToClipboard()" style="padding: 8px 16px;">
                            <span>üìã</span> Copy to Clipboard
                        </button>
                    </div>
                    <textarea id="sqlCode" readonly style="width: 100%; flex: 1; min-height: 400px; padding: 15px; background: rgba(0, 0, 0, 0.4); border: 1px solid rgba(251, 191, 36, 0.3); border-radius: 8px; color: #86efac; font-family: 'Courier New', monospace; font-size: 13px; resize: vertical; line-height: 1.5;"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeSQLModal()">Close</button>
                <button class="btn btn-primary" onclick="downloadSQL()">
                    <span>üíæ</span> Download SQL File
                </button>
            </div>
        </div>
    </div>

    <script>
        // Configuration
        const API_URL = 'http://localhost/Backend-Hostinger.php';
        const HOSTINGER_CONNECTIONS_KEY = 'hostinger_connections';
        const SELECTED_DATABASE_KEY = 'selected_database_id';
        let currentDatabase = null;
        let currentConnection = null;
        let columnCounter = 0;
        let selectedTemplate = null;

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            loadDashboardConnections();
            loadHostingerConnectionsTable();
            addColumnRow(); // Add initial column row for table creation
            
            // Load selected database from localStorage
            setTimeout(() => {
                loadSelectedDatabase();
            }, 100);
        });

        // Sidebar toggle
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainContent = document.getElementById('mainContent');
            sidebar.classList.toggle('show');
            sidebar.classList.toggle('collapsed');
            mainContent.classList.toggle('expanded');
        }

        // Section navigation
        function showSection(sectionId) {
            // Hide all sections
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            // Show selected section
            document.getElementById(sectionId).classList.add('active');
            
            // Update active nav link
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            event.target.closest('.nav-link').classList.add('active');

            // Close sidebar on mobile
            if (window.innerWidth <= 768) {
                toggleSidebar();
            }

            // Load data when entering certain sections
            if (sectionId === 'dashboard') {
                loadDashboardConnections();
            } else if (sectionId === 'settings') {
                loadHostingerConnectionsTable();
            } else if (sectionId === 'generateDatabase') {
                updateSelectedDatabaseDisplay();
            } else if (sectionId === 'createTable') {
                updateCreateTableDatabaseDisplay();
            } else if (sectionId === 'editTable') {
                updateEditTableDatabaseDisplay();
                // Auto-load tables for dropdown
                if (selectedDatabaseId) {
                    loadTablesForDropdowns();
                }
            } else if (sectionId === 'deleteTable') {
                updateDeleteTableDatabaseDisplay();
                // Auto-load tables for dropdown
                if (selectedDatabaseId) {
                    loadTablesForDropdowns();
                }
            } else if (sectionId === 'renameTable') {
                updateRenameTableDatabaseDisplay();
                // Auto-load tables for dropdown
                if (selectedDatabaseId) {
                    loadTablesForDropdowns();
                }
            } else if (sectionId === 'listTables') {
                // Auto-load tables when entering List Tables section
                if (selectedDatabaseId) {
                    setTimeout(() => {
                        loadTables();
                    }, 100);
                }
            }

            // Restore selection state when navigating
            setTimeout(() => {
                loadSelectedDatabase();
            }, 50);
        }

        // Update selected database display in Delete Table section
        function updateDeleteTableDatabaseDisplay() {
            const displayEl = document.getElementById('deleteTableDbName');
            if (!displayEl) return;

            if (selectedDatabaseId) {
                const connId = selectedDatabaseId.replace('conn_', '');
                const connections = getHostingerConnections();
                const conn = connections.find(c => c.id === connId);
                
                if (conn) {
                    displayEl.textContent = `${conn.name} (${conn.dbName})`;
                } else {
                    displayEl.textContent = 'None - Please select from Dashboard';
                }
            } else {
                displayEl.textContent = 'None - Please select from Dashboard';
            }
        }

        // Update selected database display in Rename Table section
        function updateRenameTableDatabaseDisplay() {
            const displayEl = document.getElementById('renameTableDbName');
            if (!displayEl) return;

            if (selectedDatabaseId) {
                const connId = selectedDatabaseId.replace('conn_', '');
                const connections = getHostingerConnections();
                const conn = connections.find(c => c.id === connId);
                
                if (conn) {
                    displayEl.textContent = `${conn.name} (${conn.dbName})`;
                } else {
                    displayEl.textContent = 'None - Please select from Dashboard';
                }
            } else {
                displayEl.textContent = 'None - Please select from Dashboard';
            }
        }

        // Update selected database display in Edit Table section
        function updateEditTableDatabaseDisplay() {
            const displayEl = document.getElementById('editTableDbName');
            if (!displayEl) return;

            if (selectedDatabaseId) {
                const connId = selectedDatabaseId.replace('conn_', '');
                const connections = getHostingerConnections();
                const conn = connections.find(c => c.id === connId);
                
                if (conn) {
                    displayEl.textContent = `${conn.name} (${conn.dbName})`;
                } else {
                    displayEl.textContent = 'None - Please select from Dashboard';
                }
            } else {
                displayEl.textContent = 'None - Please select from Dashboard';
            }
        }

        // Update selected database display in Create Table section
        function updateCreateTableDatabaseDisplay() {
            const displayEl = document.getElementById('createTableDbName');
            if (!displayEl) return;

            if (selectedDatabaseId) {
                const connId = selectedDatabaseId.replace('conn_', '');
                const connections = getHostingerConnections();
                const conn = connections.find(c => c.id === connId);
                
                if (conn) {
                    displayEl.textContent = `${conn.name} (${conn.dbName})`;
                } else {
                    displayEl.textContent = 'None - Please select from Dashboard';
                }
            } else {
                displayEl.textContent = 'None - Please select from Dashboard';
            }
        }

        // Update selected database display in Generate Database section
        function updateSelectedDatabaseDisplay() {
            const displayEl = document.getElementById('selectedDbNameDisplay');
            if (!displayEl) return;

            if (selectedDatabaseId) {
                const connId = selectedDatabaseId.replace('conn_', '');
                const connections = getHostingerConnections();
                const conn = connections.find(c => c.id === connId);
                
                if (conn) {
                    displayEl.textContent = `${conn.name} (${conn.dbName})`;
                    displayEl.style.color = '#22c55e';
                } else {
                    displayEl.textContent = 'None - Please select from Dashboard';
                    displayEl.style.color = '#fca5a5';
                }
            } else {
                displayEl.textContent = 'None - Please select from Dashboard';
                displayEl.style.color = '#fca5a5';
            }
        }

        // Expandable section toggle
        function toggleExpandable(id) {
            const content = document.getElementById(id);
            const toggle = document.getElementById(id + 'Toggle');
            content.classList.toggle('expanded');
            toggle.textContent = content.classList.contains('expanded') ? '‚ñ≤' : '‚ñº';
        }

        // Show message
        function showMessage(elementId, message, type) {
            const messageEl = document.getElementById(elementId);
            messageEl.className = `message ${type}`;
            messageEl.textContent = message;
            messageEl.style.display = 'block';
            setTimeout(() => {
                messageEl.style.display = 'none';
            }, 5000);
        }

        // API request helper
        async function apiRequest(action, data = {}) {
            try {
                const formData = new FormData();
                formData.append('action', action);
                for (const key in data) {
                    formData.append(key, data[key]);
                }

                const response = await fetch(API_URL, {
                    method: 'POST',
                    body: formData
                });

                return await response.json();
            } catch (error) {
                return { success: false, message: 'Network error: ' + error.message };
            }
        }

        // ========================================
        // DATABASE SELECTION & TABLE OPERATIONS
        // ========================================
        
        let selectedDatabaseId = null;

        // Load selected database from localStorage
        function loadSelectedDatabase() {
            const savedSelection = localStorage.getItem(SELECTED_DATABASE_KEY);
            if (savedSelection) {
                selectedDatabaseId = savedSelection;
                
                // Apply selection to card if it exists
                const card = document.getElementById(selectedDatabaseId);
                if (card) {
                    card.classList.add('selected');
                }

                // Show deselect button
                const deselectBtn = document.getElementById('deselectDatabaseBtn');
                if (deselectBtn) {
                    deselectBtn.classList.add('active');
                }

                // Update selected database badge
                updateSelectedDatabaseBadge();

                // Update selected database display in Generate Database section
                updateSelectedDatabaseDisplay();

                // Update selected database display in Create Table section
                updateCreateTableDatabaseDisplay();

                // Update selected database display in Edit Table section
                updateEditTableDatabaseDisplay();

                // Update selected database display in Delete Table section
                updateDeleteTableDatabaseDisplay();

                // Update selected database display in Rename Table section
                updateRenameTableDatabaseDisplay();

                // Show TABLE OPERATIONS in sidebar
                showTableOperations();
            }
        }

        // Update selected database badge with database name
        function updateSelectedDatabaseBadge() {
            if (!selectedDatabaseId) return;

            // Extract connection ID from selectedDatabaseId (format: conn_123456)
            const connId = selectedDatabaseId.replace('conn_', '');
            const connections = getHostingerConnections();
            const conn = connections.find(c => c.id === connId);

            if (conn) {
                const badgeNameEl = document.getElementById('selectedDatabaseName');
                if (badgeNameEl) {
                    badgeNameEl.textContent = conn.name;
                }
            }
        }

        // Select database
        function selectDatabase(connId) {
            // Deselect previous if any
            if (selectedDatabaseId) {
                const prevCard = document.getElementById(selectedDatabaseId);
                if (prevCard) {
                    prevCard.classList.remove('selected');
                }
            }

            // Select new database
            selectedDatabaseId = connId;
            const card = document.getElementById(connId);
            if (card) {
                card.classList.add('selected');
            }

            // Save to localStorage
            localStorage.setItem(SELECTED_DATABASE_KEY, connId);

            // Show deselect button
            const deselectBtn = document.getElementById('deselectDatabaseBtn');
            if (deselectBtn) {
                deselectBtn.classList.add('active');
            }

            // Update selected database badge
            updateSelectedDatabaseBadge();

            // Update selected database display in Generate Database section
            updateSelectedDatabaseDisplay();

            // Update selected database display in Create Table section
            updateCreateTableDatabaseDisplay();

            // Update selected database display in Edit Table section
            updateEditTableDatabaseDisplay();

            // Update selected database display in Delete Table section
            updateDeleteTableDatabaseDisplay();

            // Update selected database display in Rename Table section
            updateRenameTableDatabaseDisplay();

            // Show TABLE OPERATIONS in sidebar
            showTableOperations();
        }

        // Deselect all databases
        function deselectAllDatabases() {
            // Remove selection from card
            if (selectedDatabaseId) {
                const card = document.getElementById(selectedDatabaseId);
                if (card) {
                    card.classList.remove('selected');
                }
            }

            selectedDatabaseId = null;

            // Remove from localStorage
            localStorage.removeItem(SELECTED_DATABASE_KEY);

            // Hide deselect button
            const deselectBtn = document.getElementById('deselectDatabaseBtn');
            if (deselectBtn) {
                deselectBtn.classList.remove('active');
            }

            // Update selected database display in Generate Database section
            updateSelectedDatabaseDisplay();

            // Hide TABLE OPERATIONS in sidebar
            hideTableOperations();
        }

        // Show TABLE OPERATIONS in sidebar
        function showTableOperations() {
            const tableOpsSections = document.querySelectorAll('.nav-item.hidden-section, .section.hidden-section');
            tableOpsSections.forEach(section => {
                section.classList.remove('hidden-section');
            });

            // Show selected database badge
            const badge = document.getElementById('selectedDatabaseAlert');
            if (badge) {
                badge.classList.remove('hidden-section');
            }
        }

        // Hide TABLE OPERATIONS in sidebar
        function hideTableOperations() {
            // Get all TABLE OPERATIONS nav items
            const navItems = document.querySelectorAll('.nav-item');
            let foundTableOpsHeader = false;
            
            navItems.forEach(item => {
                // Check if this is the TABLE OPERATIONS header or comes after it
                const text = item.textContent.trim();
                if (text.includes('TABLE OPERATIONS')) {
                    foundTableOpsHeader = true;
                    item.classList.add('hidden-section');
                } else if (foundTableOpsHeader && (text.includes('List Tables') || text.includes('Create Table') || text.includes('Edit Table') || text.includes('Delete Table') || text.includes('Rename Table'))) {
                    item.classList.add('hidden-section');
                }
            });

            // Hide selected database badge
            const badge = document.getElementById('selectedDatabaseAlert');
            if (badge) {
                badge.classList.add('hidden-section');
            }

            // Hide TABLE OPERATIONS sections
            const sections = ['listTables', 'createTable', 'editTable', 'deleteTable', 'renameTable'];
            sections.forEach(id => {
                const section = document.getElementById(id);
                if (section) {
                    section.classList.add('hidden-section');
                }
            });
        }

        // ========================================
        // HOSTINGER CONNECTIONS MANAGEMENT
        // ========================================

        // Get saved connections
        function getHostingerConnections() {
            const saved = localStorage.getItem(HOSTINGER_CONNECTIONS_KEY);
            return saved ? JSON.parse(saved) : [];
        }

        // Save connections
        function saveHostingerConnections(connections) {
            localStorage.setItem(HOSTINGER_CONNECTIONS_KEY, JSON.stringify(connections));
        }

        // Add new connection
        function addHostingerConnection(event) {
            event.preventDefault();
            
            const connection = {
                id: Date.now().toString(),
                name: document.getElementById('connName').value.trim(),
                type: document.getElementById('connType').value,
                host: document.getElementById('connHost').value.trim(),
                dbName: document.getElementById('connDbName').value.trim(),
                username: document.getElementById('connUsername').value.trim(),
                password: document.getElementById('connPassword').value,
                port: document.getElementById('connPort').value.trim() || '3306',
                createdAt: new Date().toISOString()
            };

            const connections = getHostingerConnections();
            connections.push(connection);
            saveHostingerConnections(connections);

            showMessage('settingsMessage', `‚úÖ Connection "${connection.name}" added successfully!`, 'success');
            
            // Reset form
            document.getElementById('connName').value = '';
            document.getElementById('connHost').value = '192.168.8.4';
            document.getElementById('connDbName').value = '';
            document.getElementById('connUsername').value = '';
            document.getElementById('connPassword').value = '';
            document.getElementById('connPort').value = '3306';
            
            // Reset password visibility
            const passwordInput = document.getElementById('connPassword');
            const toggleBtn = document.getElementById('togglePasswordBtn');
            passwordInput.type = 'password';
            toggleBtn.textContent = 'üëÅÔ∏è';
            toggleBtn.style.background = 'rgba(59, 130, 246, 0.2)';
            toggleBtn.style.borderColor = '#3b82f6';
            toggleBtn.style.color = '#93c5fd';
            
            loadHostingerConnectionsTable();
            loadDashboardConnections();
        }

        // Edit connection
        function editHostingerConnection(id) {
            const connections = getHostingerConnections();
            const conn = connections.find(c => c.id === id);
            
            if (!conn) return;

            // Fill form with connection data
            document.getElementById('connName').value = conn.name;
            document.getElementById('connType').value = conn.type;
            document.getElementById('connHost').value = conn.host;
            document.getElementById('connDbName').value = conn.dbName;
            document.getElementById('connUsername').value = conn.username;
            document.getElementById('connPassword').value = conn.password;
            document.getElementById('connPort').value = conn.port;

            // Delete old connection
            deleteHostingerConnection(id, true);
            
            // Scroll to form
            document.querySelector('#settings .card').scrollIntoView({ behavior: 'smooth' });
        }

        // Delete connection
        function deleteHostingerConnection(id, silent = false) {
            if (!silent && !confirm('Are you sure you want to delete this connection?')) {
                return;
            }

            // Check if deleted connection is the selected one
            const connId = `conn_${id}`;
            if (selectedDatabaseId === connId) {
                deselectAllDatabases();
            }

            let connections = getHostingerConnections();
            connections = connections.filter(c => c.id !== id);
            saveHostingerConnections(connections);

            if (!silent) {
                showMessage('settingsMessage', '‚úÖ Connection deleted successfully!', 'success');
            }
            
            loadHostingerConnectionsTable();
            loadDashboardConnections();
        }

        // Clear all connections
        function clearAllHostingerConnections() {
            if (!confirm('Are you sure you want to delete ALL connections? This action cannot be undone!')) {
                return;
            }

            // Deselect if any database was selected
            deselectAllDatabases();

            localStorage.removeItem(HOSTINGER_CONNECTIONS_KEY);
            showMessage('settingsMessage', '‚úÖ All connections cleared!', 'success');
            
            loadHostingerConnectionsTable();
            loadDashboardConnections();
        }

        // Toggle password visibility in Settings
        function togglePasswordVisibility() {
            const passwordInput = document.getElementById('connPassword');
            const toggleBtn = document.getElementById('togglePasswordBtn');
            
            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                toggleBtn.textContent = 'üôà';
                toggleBtn.style.background = 'rgba(34, 197, 94, 0.2)';
                toggleBtn.style.borderColor = '#22c55e';
                toggleBtn.style.color = '#86efac';
            } else {
                passwordInput.type = 'password';
                toggleBtn.textContent = 'üëÅÔ∏è';
                toggleBtn.style.background = 'rgba(59, 130, 246, 0.2)';
                toggleBtn.style.borderColor = '#3b82f6';
                toggleBtn.style.color = '#93c5fd';
            }
        }

        // Populate autocomplete fields from previous connections
        function populateAutocompleteFields() {
            const connections = getHostingerConnections();
            
            // Get unique values
            const hosts = [...new Set(connections.map(c => c.host))];
            const dbNames = [...new Set(connections.map(c => c.dbName))];
            const usernames = [...new Set(connections.map(c => c.username))];

            // Populate Host datalist
            const hostList = document.getElementById('hostList');
            hostList.innerHTML = hosts.map(h => `<option value="${h}">`).join('');

            // Populate Database Name datalist
            const dbNameList = document.getElementById('dbNameList');
            dbNameList.innerHTML = dbNames.map(db => `<option value="${db}">`).join('');

            // Populate Username datalist
            const usernameList = document.getElementById('usernameList');
            usernameList.innerHTML = usernames.map(u => `<option value="${u}">`).join('');
        }

        // Toggle password visibility in table
        function toggleTablePassword(connId, password) {
            const pwdSpan = document.getElementById(`pwd_${connId}`);
            const pwdBtn = document.getElementById(`pwdBtn_${connId}`);
            
            if (pwdSpan.textContent.includes('‚Ä¢')) {
                // Show password
                pwdSpan.textContent = password;
                pwdBtn.textContent = 'üôà';
                pwdBtn.style.background = 'rgba(34, 197, 94, 0.2)';
                pwdBtn.style.borderColor = '#22c55e';
                pwdBtn.style.color = '#86efac';
            } else {
                // Hide password
                pwdSpan.textContent = '‚Ä¢'.repeat(password.length);
                pwdBtn.textContent = 'üëÅÔ∏è';
                pwdBtn.style.background = 'rgba(59, 130, 246, 0.2)';
                pwdBtn.style.borderColor = '#3b82f6';
                pwdBtn.style.color = '#93c5fd';
            }
        }

        // Load connections table in Settings
        function loadHostingerConnectionsTable() {
            const tableEl = document.getElementById('hostingerConnectionsTable');
            const connections = getHostingerConnections();

            // Populate autocomplete fields
            populateAutocompleteFields();

            if (connections.length === 0) {
                tableEl.innerHTML = '<p style="color: rgba(254, 243, 199, 0.6); text-align: center; padding: 20px;">No connections saved yet.</p>';
                return;
            }

            let html = `
                <div style="overflow-x: auto;">
                    <table style="width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr style="background: rgba(251, 191, 36, 0.1); border-bottom: 2px solid rgba(251, 191, 36, 0.3);">
                                <th style="padding: 12px; text-align: left; color: #fbbf24;">Name</th>
                                <th style="padding: 12px; text-align: left; color: #fbbf24;">Type</th>
                                <th style="padding: 12px; text-align: left; color: #fbbf24;">Host</th>
                                <th style="padding: 12px; text-align: left; color: #fbbf24;">Database</th>
                                <th style="padding: 12px; text-align: left; color: #fbbf24;">Username</th>
                                <th style="padding: 12px; text-align: left; color: #fbbf24;">Password</th>
                                <th style="padding: 12px; text-align: center; color: #fbbf24;">Actions</th>
                            </tr>
                        </thead>
                        <tbody>`;

            connections.forEach(conn => {
                const typeIcon = conn.type === 'vps' ? 'üñ•Ô∏è' : 'üåê';
                const maskedPassword = '‚Ä¢'.repeat(conn.password.length);
                html += `
                    <tr style="border-bottom: 1px solid rgba(251, 191, 36, 0.1);">
                        <td style="padding: 12px; color: #fef3c7;"><strong>${conn.name}</strong></td>
                        <td style="padding: 12px; color: rgba(254, 243, 199, 0.7);">${typeIcon} ${conn.type.toUpperCase()}</td>
                        <td style="padding: 12px; color: rgba(254, 243, 199, 0.7); font-family: monospace; font-size: 13px;">${conn.host}</td>
                        <td style="padding: 12px; color: rgba(254, 243, 199, 0.7); font-family: monospace; font-size: 13px;">${conn.dbName}</td>
                        <td style="padding: 12px; color: rgba(254, 243, 199, 0.7);">${conn.username}</td>
                        <td style="padding: 12px;">
                            <div style="display: flex; align-items: center; gap: 8px;">
                                <span id="pwd_${conn.id}" style="font-family: monospace; color: rgba(254, 243, 199, 0.7); font-size: 13px;">${maskedPassword}</span>
                                <button onclick="toggleTablePassword('${conn.id}', '${conn.password.replace(/'/g, "\\'")}')" style="background: rgba(59, 130, 246, 0.2); border: 1px solid #3b82f6; color: #93c5fd; padding: 4px 8px; border-radius: 4px; cursor: pointer; font-size: 14px; transition: all 0.3s;" id="pwdBtn_${conn.id}">
                                    üëÅÔ∏è
                                </button>
                            </div>
                        </td>
                        <td style="padding: 12px; text-align: center;">
                            <button class="btn btn-secondary" style="padding: 6px 12px; margin-right: 5px; font-size: 12px;" onclick="editHostingerConnection('${conn.id}')">‚úèÔ∏è Edit</button>
                            <button class="btn btn-danger" style="padding: 6px 12px; font-size: 12px;" onclick="deleteHostingerConnection('${conn.id}')">üóëÔ∏è Delete</button>
                        </td>
                    </tr>`;
            });

            html += `
                        </tbody>
                    </table>
                </div>`;

            tableEl.innerHTML = html;
        }

        // Load connections in Dashboard with Test Connection
        async function loadDashboardConnections() {
            const listEl = document.getElementById('configuredConnectionsList');
            const connections = getHostingerConnections();

            if (connections.length === 0) {
                listEl.innerHTML = `
                    <p style="color: rgba(254, 243, 199, 0.6); text-align: center; padding: 40px;">
                        No Hostinger connections configured.<br>
                        <span style="font-size: 14px;">Go to <strong>Hostinger Connections</strong> in the sidebar to add your first connection.</span>
                    </p>`;
                return;
            }

            let html = '';
            connections.forEach(conn => {
                const typeIcon = conn.type === 'vps' ? 'üñ•Ô∏è' : 'üåê';
                const connId = `conn_${conn.id}`;
                html += `
                    <div class="database-item" id="${connId}" onclick="selectDatabase('${connId}')">
                        <!-- Row 1: Logo/Icon -->
                        <div class="database-icon-row">
                            <span class="database-icon">${typeIcon}</span>
                        </div>
                        
                        <!-- Row 2: Text Content -->
                        <div class="database-text-row">
                            <div class="database-name">${conn.name}</div>
                            <div class="database-info-item">üìÅ ${conn.dbName}</div>
                            <div class="database-info-item">üñ•Ô∏è ${conn.host}</div>
                        </div>
                        
                        <!-- Row 3: Status + Button -->
                        <div class="database-actions-row">
                            <div id="${connId}_status" class="database-status testing">
                                <span class="spinner"></span>
                                <span>Testing connection...</span>
                            </div>
                            <button class="btn btn-primary database-button" onclick="event.stopPropagation(); testConnectionManual('${conn.id}')">
                                <span>üîÑ</span> Test Again
                            </button>
                        </div>
                    </div>`;
            });

            listEl.innerHTML = html;

            // Auto-test all connections
            connections.forEach(conn => {
                testConnection(conn.id);
            });

            // Restore selected database if exists
            setTimeout(() => {
                loadSelectedDatabase();
            }, 50);
        }

        // Test connection (automatic on load)
        async function testConnection(connId) {
            const connections = getHostingerConnections();
            const conn = connections.find(c => c.id === connId);
            
            if (!conn) return;

            const statusEl = document.getElementById(`conn_${connId}_status`);
            
            try {
                const result = await apiRequest('check_connection', {
                    db_host: conn.host,
                    db_name: conn.dbName,
                    db_user: conn.username,
                    db_pass: conn.password,
                    db_port: conn.port
                });

                if (result.success) {
                    statusEl.className = 'database-status success';
                    statusEl.innerHTML = '‚úÖ Connected successfully!';
                } else {
                    statusEl.className = 'database-status error';
                    statusEl.innerHTML = `‚ùå Connection failed: ${result.message}`;
                }
            } catch (error) {
                statusEl.className = 'database-status error';
                statusEl.innerHTML = `‚ùå Error: ${error.message}`;
            }
        }

        // Test connection manually (when clicking Test Again button)
        function testConnectionManual(connId) {
            const statusEl = document.getElementById(`conn_${connId}_status`);
            statusEl.className = 'database-status testing';
            statusEl.innerHTML = '<span class="spinner"></span><span>Testing connection...</span>';
            
            testConnection(connId);
        }

        // ========================================
        // NOTE: Old database operations functions below
        // These will need to be updated for Hostinger connections
        // ========================================

        // Load databases
        async function loadDatabases() {
            const listEl = document.getElementById('databaseList');
            listEl.innerHTML = '<div class="spinner"></div> Loading databases...';
            
            const result = await apiRequest('list_databases');
            
            if (result.success) {
                const credentials = getSavedCredentials();
                if (result.databases.length === 0) {
                    listEl.innerHTML = '<p style="color: rgba(254, 243, 199, 0.6); text-align: center; padding: 20px;">No databases found</p>';
                } else {
                    listEl.innerHTML = result.databases.map(db => {
                        const hasCredentials = credentials.some(c => c.dbName === db);
                        return `
                            <div class="database-item" onclick="connectToDatabase('${db}')">
                                ${hasCredentials ? '<span class="lock-icon">üîí</span>' : ''}
                                <div class="database-name">
                                    <span class="database-icon">üóÑÔ∏è</span>
                                    <span>${db}</span>
                                </div>
                            </div>
                        `;
                    }).join('');
                }
                showMessage('listMessage', `‚úÖ Found ${result.databases.length} database(s)`, 'success');
            } else {
                listEl.innerHTML = '';
                showMessage('listMessage', '‚ùå ' + result.message, 'error');
            }
        }

        // Load databases for dropdowns
        async function loadDatabasesForDropdowns() {
            const result = await apiRequest('list_databases');
            
            if (result.success) {
                const options = result.databases.map(db => 
                    `<option value="${db}">${db}</option>`
                ).join('');
                
                document.getElementById('deleteDbSelect').innerHTML = '<option value="">-- Select Database --</option>' + options;
                document.getElementById('renameOldSelect').innerHTML = '<option value="">-- Select Database --</option>' + options;
                document.getElementById('credentialsDbSelect').innerHTML = '<option value="">-- Select Database --</option>' + options;
            }
        }

        // Connect to database
        async function connectToDatabase(dbName) {
            currentDatabase = dbName;
            const savedCreds = getCredentialsForDatabase(dbName);
            
            // Try connection with saved credentials first
            let username = savedCreds ? savedCreds.username : '';
            let password = savedCreds ? savedCreds.password : '';
            
            showMessage('listMessage', `üîÑ Connecting to ${dbName}...`, 'info');
            
            const result = await apiRequest('connect_database', {
                db_name: dbName,
                db_username: username,
                db_password: password
            });
            
            if (result.success) {
                showMessage('listMessage', `‚úÖ ${result.message}`, 'success');
                updateConnectionStatus(dbName);
            } else if (result.requiresCredentials) {
                // Show credentials modal
                openConnectionModal(dbName, result.message);
            } else {
                showMessage('listMessage', `‚ùå ${result.message}`, 'error');
            }
        }

        // Open connection modal
        function openConnectionModal(dbName, message) {
            document.getElementById('modalTitle').textContent = `Connect to ${dbName}`;
            document.getElementById('modalMessage').textContent = message || 'This database requires authentication';
            document.getElementById('modalUsername').value = '';
            document.getElementById('modalPassword').value = '';
            populateSavedUsernames();
            document.getElementById('connectionModal').classList.add('active');
        }

        // Close connection modal
        function closeConnectionModal() {
            document.getElementById('connectionModal').classList.remove('active');
            currentDatabase = null;
        }

        // Submit connection
        async function submitConnection() {
            const username = document.getElementById('modalUsername').value;
            const password = document.getElementById('modalPassword').value;
            
            if (!username || !password) {
                alert('Please enter both username and password');
                return;
            }
            
            const result = await apiRequest('connect_database', {
                db_name: currentDatabase,
                db_username: username,
                db_password: password
            });
            
            if (result.success) {
                // Save credentials
                saveCredentials(currentDatabase, username, password);
                showMessage('listMessage', `‚úÖ ${result.message} (Credentials saved)`, 'success');
                closeConnectionModal();
                loadDatabases(); // Refresh to show lock icon
                updateConnectionStatus(currentDatabase);
            } else {
                document.getElementById('modalMessage').textContent = '‚ùå ' + result.message;
            }
        }

        // Create database
        async function createDatabase(event) {
            event.preventDefault();
            
            const dbName = document.getElementById('newDbName').value.trim();
            const username = document.getElementById('newDbUsername').value.trim();
            const password = document.getElementById('newDbPassword').value.trim();
            
            if (!dbName) {
                showMessage('createMessage', '‚ùå Please enter a database name', 'error');
                return;
            }
            
            showMessage('createMessage', 'üîÑ Creating database...', 'info');
            
            const result = await apiRequest('create_database', {
                db_name: dbName,
                db_username: username,
                db_password: password
            });
            
            if (result.success) {
                showMessage('createMessage', `‚úÖ ${result.message}`, 'success');
                document.getElementById('newDbName').value = '';
                document.getElementById('newDbUsername').value = '';
                document.getElementById('newDbPassword').value = '';
                
                // Save credentials if provided
                if (username && password) {
                    saveCredentials(dbName, username, password);
                    showMessage('createMessage', `‚úÖ ${result.message} (Credentials saved for future use)`, 'success');
                }
                
                loadDatabasesForDropdowns();
                loadDatabases();
            } else {
                showMessage('createMessage', `‚ùå ${result.message}`, 'error');
            }
        }

        // Delete database
        async function deleteDatabase(event) {
            event.preventDefault();
            
            const dbName = document.getElementById('deleteDbSelect').value;
            
            if (!dbName) {
                showMessage('deleteMessage', '‚ùå Please select a database', 'error');
                return;
            }
            
            if (!confirm(`Are you sure you want to delete the database "${dbName}"?\n\nThis action cannot be undone!`)) {
                return;
            }
            
            showMessage('deleteMessage', 'üîÑ Deleting database...', 'info');
            
            const result = await apiRequest('delete_database', { db_name: dbName });
            
            if (result.success) {
                showMessage('deleteMessage', `‚úÖ ${result.message}`, 'success');
                document.getElementById('deleteDbSelect').value = '';
                loadDatabasesForDropdowns();
                loadDatabases();
                
                // Remove saved credentials
                let credentials = getSavedCredentials();
                credentials = credentials.filter(c => c.dbName !== dbName);
                localStorage.setItem(CREDENTIALS_KEY, JSON.stringify(credentials));
            } else {
                showMessage('deleteMessage', `‚ùå ${result.message}`, 'error');
            }
        }

        // Rename database
        async function renameDatabase(event) {
            event.preventDefault();
            
            const oldName = document.getElementById('renameOldSelect').value;
            const newName = document.getElementById('renameNewName').value.trim();
            
            if (!oldName || !newName) {
                showMessage('renameMessage', '‚ùå Please provide both old and new database names', 'error');
                return;
            }
            
            if (oldName === newName) {
                showMessage('renameMessage', '‚ùå New name must be different from old name', 'error');
                return;
            }
            
            showMessage('renameMessage', 'üîÑ Renaming database...', 'info');
            
            const result = await apiRequest('rename_database', {
                old_name: oldName,
                new_name: newName
            });
            
            if (result.success) {
                showMessage('renameMessage', `‚úÖ ${result.message}`, 'success');
                document.getElementById('renameOldSelect').value = '';
                document.getElementById('renameNewName').value = '';
                loadDatabasesForDropdowns();
                loadDatabases();
                
                // Update saved credentials
                let credentials = getSavedCredentials();
                const cred = credentials.find(c => c.dbName === oldName);
                if (cred) {
                    cred.dbName = newName;
                    localStorage.setItem(CREDENTIALS_KEY, JSON.stringify(credentials));
                }
            } else {
                showMessage('renameMessage', `‚ùå ${result.message}`, 'error');
            }
        }

        // Check existing credentials
        function checkExistingCredentials() {
            const dbName = document.getElementById('credentialsDbSelect').value;
            const statusEl = document.getElementById('credentialStatus');
            
            if (!dbName) {
                statusEl.innerHTML = '';
                return;
            }
            
            const savedCreds = getCredentialsForDatabase(dbName);
            
            if (savedCreds) {
                statusEl.innerHTML = `<div class="message info" style="display: block;">‚ÑπÔ∏è This database already has saved credentials (User: ${savedCreds.username}). You can update them below.</div>`;
            } else {
                statusEl.innerHTML = `<div class="message info" style="display: block;">‚ÑπÔ∏è This database has no saved credentials. Add username and password to secure it.</div>`;
            }
        }

        // Set database credentials
        async function setDatabaseCredentials(event) {
            event.preventDefault();
            
            const dbName = document.getElementById('credentialsDbSelect').value;
            const username = document.getElementById('credentialsUsername').value.trim();
            const password = document.getElementById('credentialsPassword').value;
            const confirmPassword = document.getElementById('credentialsConfirmPassword').value;
            
            if (!dbName || !username || !password) {
                showMessage('credentialsMessage', '‚ùå Please fill in all fields', 'error');
                return;
            }
            
            if (password !== confirmPassword) {
                showMessage('credentialsMessage', '‚ùå Passwords do not match', 'error');
                return;
            }
            
            showMessage('credentialsMessage', 'üîÑ Setting credentials...', 'info');
            
            const result = await apiRequest('set_database_credentials', {
                db_name: dbName,
                db_username: username,
                db_password: password
            });
            
            if (result.success) {
                showMessage('credentialsMessage', `‚úÖ ${result.message}`, 'success');
                
                // Save credentials
                saveCredentials(dbName, username, password);
                
                // Reset form
                document.getElementById('credentialsDbSelect').value = '';
                document.getElementById('credentialsUsername').value = '';
                document.getElementById('credentialsPassword').value = '';
                document.getElementById('credentialsConfirmPassword').value = '';
                document.getElementById('credentialStatus').innerHTML = '';
                
                loadDatabases(); // Refresh to show lock icon
            } else {
                showMessage('credentialsMessage', `‚ùå ${result.message}`, 'error');
            }
        }

        // ========================================
        // TABLE OPERATIONS FUNCTIONS
        // ========================================

        // Update connection status display
        function updateConnectionStatus(dbName) {
            const statusElements = [
                'tableConnectionStatus',
                'createTableConnectionStatus',
                'editTableConnectionStatus',
                'deleteTableConnectionStatus',
                'renameTableConnectionStatus'
            ];
            
            statusElements.forEach(id => {
                const el = document.getElementById(id);
                if (el) {
                    el.textContent = `‚úÖ Connected to database: ${dbName}`;
                    el.classList.add('active');
                }
            });

            // Load tables for dropdowns when database is connected
            loadTablesForDropdowns();
        }

        // Tab switching for create table
        function switchTab(tabName) {
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            if (tabName === 'manual') {
                document.querySelector('.tab-btn:nth-child(1)').classList.add('active');
                document.getElementById('manualTab').classList.add('active');
            } else {
                document.querySelector('.tab-btn:nth-child(2)').classList.add('active');
                document.getElementById('templateTab').classList.add('active');
                loadTemplates();
            }
        }

        // Load table templates
        function loadTemplates() {
            const templates = [
                { name: 'Users', icon: 'üë§', desc: 'User accounts', columns: [
                    { name: 'id', type: 'INT', length: '11', nullable: 'no', autoIncrement: 'yes', primaryKey: 'yes' },
                    { name: 'username', type: 'VARCHAR', length: '50', nullable: 'no', unique: 'yes' },
                    { name: 'email', type: 'VARCHAR', length: '100', nullable: 'no', unique: 'yes' },
                    { name: 'password', type: 'VARCHAR', length: '255', nullable: 'no' },
                    { name: 'created_at', type: 'TIMESTAMP', defaultValue: 'CURRENT_TIMESTAMP', nullable: 'no' }
                ]},
                { name: 'Products', icon: 'üì¶', desc: 'Product catalog', columns: [
                    { name: 'id', type: 'INT', length: '11', nullable: 'no', autoIncrement: 'yes', primaryKey: 'yes' },
                    { name: 'name', type: 'VARCHAR', length: '200', nullable: 'no' },
                    { name: 'description', type: 'TEXT', nullable: 'yes' },
                    { name: 'price', type: 'DECIMAL', length: '10,2', nullable: 'no' },
                    { name: 'stock', type: 'INT', length: '11', nullable: 'no', defaultValue: '0' },
                    { name: 'created_at', type: 'TIMESTAMP', defaultValue: 'CURRENT_TIMESTAMP', nullable: 'no' }
                ]},
                { name: 'Blog Posts', icon: 'üìù', desc: 'Blog articles', columns: [
                    { name: 'id', type: 'INT', length: '11', nullable: 'no', autoIncrement: 'yes', primaryKey: 'yes' },
                    { name: 'title', type: 'VARCHAR', length: '255', nullable: 'no' },
                    { name: 'slug', type: 'VARCHAR', length: '255', nullable: 'no', unique: 'yes' },
                    { name: 'content', type: 'TEXT', nullable: 'no' },
                    { name: 'author_id', type: 'INT', length: '11', nullable: 'no' },
                    { name: 'published_at', type: 'DATETIME', nullable: 'yes' },
                    { name: 'created_at', type: 'TIMESTAMP', defaultValue: 'CURRENT_TIMESTAMP', nullable: 'no' }
                ]},
                { name: 'Orders', icon: 'üõí', desc: 'Customer orders', columns: [
                    { name: 'id', type: 'INT', length: '11', nullable: 'no', autoIncrement: 'yes', primaryKey: 'yes' },
                    { name: 'user_id', type: 'INT', length: '11', nullable: 'no' },
                    { name: 'total_amount', type: 'DECIMAL', length: '10,2', nullable: 'no' },
                    { name: 'status', type: 'VARCHAR', length: '50', nullable: 'no', defaultValue: 'pending' },
                    { name: 'created_at', type: 'TIMESTAMP', defaultValue: 'CURRENT_TIMESTAMP', nullable: 'no' }
                ]},
                { name: 'Categories', icon: 'üìÅ', desc: 'Content categories', columns: [
                    { name: 'id', type: 'INT', length: '11', nullable: 'no', autoIncrement: 'yes', primaryKey: 'yes' },
                    { name: 'name', type: 'VARCHAR', length: '100', nullable: 'no' },
                    { name: 'slug', type: 'VARCHAR', length: '100', nullable: 'no', unique: 'yes' },
                    { name: 'parent_id', type: 'INT', length: '11', nullable: 'yes' },
                    { name: 'created_at', type: 'TIMESTAMP', defaultValue: 'CURRENT_TIMESTAMP', nullable: 'no' }
                ]},
                { name: 'Comments', icon: 'üí¨', desc: 'User comments', columns: [
                    { name: 'id', type: 'INT', length: '11', nullable: 'no', autoIncrement: 'yes', primaryKey: 'yes' },
                    { name: 'user_id', type: 'INT', length: '11', nullable: 'no' },
                    { name: 'post_id', type: 'INT', length: '11', nullable: 'no' },
                    { name: 'content', type: 'TEXT', nullable: 'no' },
                    { name: 'created_at', type: 'TIMESTAMP', defaultValue: 'CURRENT_TIMESTAMP', nullable: 'no' }
                ]},
                { name: 'Media', icon: 'üñºÔ∏è', desc: 'Media files', columns: [
                    { name: 'id', type: 'INT', length: '11', nullable: 'no', autoIncrement: 'yes', primaryKey: 'yes' },
                    { name: 'filename', type: 'VARCHAR', length: '255', nullable: 'no' },
                    { name: 'filepath', type: 'VARCHAR', length: '500', nullable: 'no' },
                    { name: 'filetype', type: 'VARCHAR', length: '50', nullable: 'no' },
                    { name: 'filesize', type: 'INT', length: '11', nullable: 'no' },
                    { name: 'uploaded_at', type: 'TIMESTAMP', defaultValue: 'CURRENT_TIMESTAMP', nullable: 'no' }
                ]},
                { name: 'Settings', icon: '‚öôÔ∏è', desc: 'App settings', columns: [
                    { name: 'id', type: 'INT', length: '11', nullable: 'no', autoIncrement: 'yes', primaryKey: 'yes' },
                    { name: 'key', type: 'VARCHAR', length: '100', nullable: 'no', unique: 'yes' },
                    { name: 'value', type: 'TEXT', nullable: 'yes' },
                    { name: 'updated_at', type: 'TIMESTAMP', defaultValue: 'CURRENT_TIMESTAMP', nullable: 'no' }
                ]},
                { name: 'Logs', icon: 'üìã', desc: 'Activity logs', columns: [
                    { name: 'id', type: 'INT', length: '11', nullable: 'no', autoIncrement: 'yes', primaryKey: 'yes' },
                    { name: 'user_id', type: 'INT', length: '11', nullable: 'yes' },
                    { name: 'action', type: 'VARCHAR', length: '100', nullable: 'no' },
                    { name: 'description', type: 'TEXT', nullable: 'yes' },
                    { name: 'ip_address', type: 'VARCHAR', length: '45', nullable: 'yes' },
                    { name: 'created_at', type: 'TIMESTAMP', defaultValue: 'CURRENT_TIMESTAMP', nullable: 'no' }
                ]},
                { name: 'Sessions', icon: 'üîê', desc: 'User sessions', columns: [
                    { name: 'id', type: 'INT', length: '11', nullable: 'no', autoIncrement: 'yes', primaryKey: 'yes' },
                    { name: 'user_id', type: 'INT', length: '11', nullable: 'no' },
                    { name: 'token', type: 'VARCHAR', length: '255', nullable: 'no', unique: 'yes' },
                    { name: 'ip_address', type: 'VARCHAR', length: '45', nullable: 'yes' },
                    { name: 'user_agent', type: 'TEXT', nullable: 'yes' },
                    { name: 'expires_at', type: 'DATETIME', nullable: 'no' },
                    { name: 'created_at', type: 'TIMESTAMP', defaultValue: 'CURRENT_TIMESTAMP', nullable: 'no' }
                ]}
            ];

            const grid = document.getElementById('templateGrid');
            grid.innerHTML = templates.map(t => `
                <div class="template-card" onclick="selectTemplate('${t.name}')">
                    <div class="template-icon">${t.icon}</div>
                    <div class="template-name">${t.name}</div>
                    <div class="template-desc">${t.desc}</div>
                </div>
            `).join('');

            window.tableTemplates = templates;
        }

        // Select template
        function selectTemplate(templateName) {
            selectedTemplate = window.tableTemplates.find(t => t.name === templateName);
            
            // Update UI
            document.querySelectorAll('.template-card').forEach(card => card.classList.remove('selected'));
            event.target.closest('.template-card').classList.add('selected');
            
            // Show template columns
            const container = document.getElementById('templateColumns');
            container.innerHTML = '';
            
            selectedTemplate.columns.forEach((col, index) => {
                container.innerHTML += createColumnRow(col, index, true);
            });
            
            document.getElementById('templateColumnBuilder').style.display = 'block';
        }

        // Create column row HTML
        function createColumnRow(col = {}, index = columnCounter++, isTemplate = false) {
            const prefix = isTemplate ? 'template' : 'col';
            const id = `${prefix}_${index}`;
            
            return `
                <div class="column-row" id="${id}">
                    <div class="form-group" style="margin: 0;">
                        <input type="text" class="form-input col-name" placeholder="Column name" value="${col.name || ''}" required>
                    </div>
                    <div class="form-group" style="margin: 0;">
                        <select class="form-select col-type">
                            <option value="INT" ${col.type === 'INT' ? 'selected' : ''}>INT</option>
                            <option value="VARCHAR" ${col.type === 'VARCHAR' ? 'selected' : ''}>VARCHAR</option>
                            <option value="TEXT" ${col.type === 'TEXT' ? 'selected' : ''}>TEXT</option>
                            <option value="DATE" ${col.type === 'DATE' ? 'selected' : ''}>DATE</option>
                            <option value="DATETIME" ${col.type === 'DATETIME' ? 'selected' : ''}>DATETIME</option>
                            <option value="TIMESTAMP" ${col.type === 'TIMESTAMP' ? 'selected' : ''}>TIMESTAMP</option>
                            <option value="BOOLEAN" ${col.type === 'BOOLEAN' ? 'selected' : ''}>BOOLEAN</option>
                            <option value="DECIMAL" ${col.type === 'DECIMAL' ? 'selected' : ''}>DECIMAL</option>
                            <option value="FLOAT" ${col.type === 'FLOAT' ? 'selected' : ''}>FLOAT</option>
                            <option value="DOUBLE" ${col.type === 'DOUBLE' ? 'selected' : ''}>DOUBLE</option>
                            <option value="BLOB" ${col.type === 'BLOB' ? 'selected' : ''}>BLOB</option>
                        </select>
                    </div>
                    <div class="form-group" style="margin: 0;">
                        <input type="text" class="form-input col-length" placeholder="Length" value="${col.length || ''}">
                    </div>
                    <div class="form-group" style="margin: 0;">
                        <select class="form-select col-nullable">
                            <option value="yes" ${col.nullable === 'yes' ? 'selected' : ''}>NULL</option>
                            <option value="no" ${col.nullable === 'no' ? 'selected' : ''}>NOT NULL</option>
                        </select>
                    </div>
                    <div class="form-group" style="margin: 0;">
                        <input type="text" class="form-input col-default" placeholder="Default" value="${col.defaultValue || ''}">
                    </div>
                    <button type="button" class="btn btn-danger btn-icon" onclick="removeColumnRow('${id}')">√ó</button>
                </div>
                <div class="column-options">
                    <div class="checkbox-group">
                        <input type="checkbox" id="${id}_auto" class="col-auto" ${col.autoIncrement === 'yes' ? 'checked' : ''}>
                        <label for="${id}_auto">Auto Increment</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="${id}_pk" class="col-pk" ${col.primaryKey === 'yes' ? 'checked' : ''}>
                        <label for="${id}_pk">Primary Key</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="${id}_unique" class="col-unique" ${col.unique === 'yes' ? 'checked' : ''}>
                        <label for="${id}_unique">Unique</label>
                    </div>
                </div>
            `;
        }

        // Add column row
        function addColumnRow() {
            const builder = document.getElementById('columnBuilder');
            const div = document.createElement('div');
            div.innerHTML = createColumnRow();
            builder.appendChild(div);
        }

        // Remove column row
        function removeColumnRow(id) {
            document.getElementById(id).nextElementSibling.remove();
            document.getElementById(id).remove();
        }

        // Get columns data from form
        function getColumnsData(containerId) {
            const container = document.getElementById(containerId);
            const rows = container.querySelectorAll('.column-row');
            const columns = [];
            
            rows.forEach(row => {
                const col = {
                    name: row.querySelector('.col-name').value.trim(),
                    type: row.querySelector('.col-type').value,
                    length: row.querySelector('.col-length').value.trim(),
                    nullable: row.querySelector('.col-nullable').value,
                    defaultValue: row.querySelector('.col-default').value.trim(),
                    autoIncrement: row.querySelector('.col-auto')?.checked ? 'yes' : 'no',
                    primaryKey: row.querySelector('.col-pk')?.checked ? 'yes' : 'no',
                    unique: row.querySelector('.col-unique')?.checked ? 'yes' : 'no'
                };
                
                if (col.name) {
                    columns.push(col);
                }
            });
            
            return columns;
        }

        // Preview SQL
        function previewSQL() {
            const tableName = document.getElementById('newTableName').value.trim();
            const columns = getColumnsData('columnBuilder');
            
            if (!tableName || columns.length === 0) {
                alert('Please enter table name and add at least one column');
                return;
            }
            
            const sql = generateCreateTableSQL(tableName, columns);
            document.getElementById('sqlPreview').textContent = sql;
            document.getElementById('sqlPreview').style.display = 'block';
        }

        // Preview template SQL
        function previewTemplateSQL() {
            const tableName = document.getElementById('templateTableName').value.trim();
            const columns = getColumnsData('templateColumns');
            
            if (!tableName || columns.length === 0) {
                alert('Please enter table name and select a template');
                return;
            }
            
            const sql = generateCreateTableSQL(tableName, columns);
            document.getElementById('templateSqlPreview').textContent = sql;
            document.getElementById('templateSqlPreview').style.display = 'block';
        }

        // Generate CREATE TABLE SQL
        function generateCreateTableSQL(tableName, columns) {
            let sql = `CREATE TABLE \`${tableName}\` (\n`;
            const columnDefs = [];
            const primaryKeys = [];
            
            columns.forEach(col => {
                let def = `  \`${col.name}\` ${col.type}`;
                
                if (col.length && ['VARCHAR', 'CHAR', 'INT', 'DECIMAL', 'FLOAT', 'DOUBLE'].includes(col.type)) {
                    def += `(${col.length})`;
                }
                
                if (col.nullable === 'no') {
                    def += ' NOT NULL';
                }
                
                if (col.autoIncrement === 'yes') {
                    def += ' AUTO_INCREMENT';
                }
                
                if (col.defaultValue) {
                    if (col.defaultValue.toUpperCase() === 'NULL') {
                        def += ' DEFAULT NULL';
                    } else if (col.defaultValue.toUpperCase() === 'CURRENT_TIMESTAMP') {
                        def += ' DEFAULT CURRENT_TIMESTAMP';
                    } else {
                        def += ` DEFAULT '${col.defaultValue}'`;
                    }
                }
                
                if (col.unique === 'yes') {
                    def += ' UNIQUE';
                }
                
                columnDefs.push(def);
                
                if (col.primaryKey === 'yes') {
                    primaryKeys.push(`\`${col.name}\``);
                }
            });
            
            sql += columnDefs.join(',\n');
            
            if (primaryKeys.length > 0) {
                sql += ',\n  PRIMARY KEY (' + primaryKeys.join(', ') + ')';
            }
            
            sql += '\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;';
            
            return sql;
        }

        // Create table (manual)
        async function createTableManual(event) {
            event.preventDefault();
            
            if (!selectedDatabaseId) {
                showMessage('createTableMessage', '‚ùå Please select a database from Dashboard first', 'error');
                return;
            }

            const connId = selectedDatabaseId.replace('conn_', '');
            const connections = getHostingerConnections();
            const conn = connections.find(c => c.id === connId);
            
            if (!conn) {
                showMessage('createTableMessage', '‚ùå Selected database connection not found', 'error');
                return;
            }
            
            const tableName = document.getElementById('newTableName').value.trim();
            const columns = getColumnsData('columnBuilder');
            
            if (!tableName) {
                showMessage('createTableMessage', '‚ùå Please enter a table name', 'error');
                return;
            }
            
            if (columns.length === 0) {
                showMessage('createTableMessage', '‚ùå Please add at least one column', 'error');
                return;
            }
            
            showMessage('createTableMessage', 'üîÑ Creating table...', 'info');
            
            const result = await apiRequest('create_table', {
                db_host: conn.host,
                db_name: conn.dbName,
                db_user: conn.username,
                db_pass: conn.password,
                db_port: conn.port,
                table_name: tableName,
                columns: JSON.stringify(columns)
            });
            
            if (result.success) {
                showMessage('createTableMessage', `‚úÖ ${result.message}`, 'success');
                document.getElementById('newTableName').value = '';
                document.getElementById('columnBuilder').innerHTML = '';
                document.getElementById('sqlPreview').style.display = 'none';
                addColumnRow(); // Re-add one empty column row
                loadTablesForDropdowns();
                // Refresh table list if we're in that section
                if (document.getElementById('listTables').classList.contains('active')) {
                    loadTables();
                }
            } else {
                showMessage('createTableMessage', `‚ùå ${result.message}`, 'error');
            }
        }

        // Create table from template
        async function createTableFromTemplate(event) {
            event.preventDefault();
            
            if (!selectedDatabaseId) {
                showMessage('createTableMessage', '‚ùå Please select a database from Dashboard first', 'error');
                return;
            }

            const connId = selectedDatabaseId.replace('conn_', '');
            const connections = getHostingerConnections();
            const conn = connections.find(c => c.id === connId);
            
            if (!conn) {
                showMessage('createTableMessage', '‚ùå Selected database connection not found', 'error');
                return;
            }
            
            const tableName = document.getElementById('templateTableName').value.trim();
            const columns = getColumnsData('templateColumns');
            
            if (!tableName) {
                showMessage('createTableMessage', '‚ùå Please enter a table name', 'error');
                return;
            }
            
            if (columns.length === 0) {
                showMessage('createTableMessage', '‚ùå Please select a template', 'error');
                return;
            }
            
            showMessage('createTableMessage', 'üîÑ Creating table from template...', 'info');
            
            const result = await apiRequest('create_table', {
                db_host: conn.host,
                db_name: conn.dbName,
                db_user: conn.username,
                db_pass: conn.password,
                db_port: conn.port,
                table_name: tableName,
                columns: JSON.stringify(columns)
            });
            
            if (result.success) {
                showMessage('createTableMessage', `‚úÖ ${result.message}`, 'success');
                document.getElementById('templateTableName').value = '';
                document.getElementById('templateColumns').innerHTML = '';
                document.getElementById('templateColumnBuilder').style.display = 'none';
                document.getElementById('templateSqlPreview').style.display = 'none';
                selectedTemplate = null;
                document.querySelectorAll('.template-card').forEach(card => card.classList.remove('selected'));
                loadTablesForDropdowns();
                // Refresh table list if we're in that section
                if (document.getElementById('listTables').classList.contains('active')) {
                    loadTables();
                }
            } else {
                showMessage('createTableMessage', `‚ùå ${result.message}`, 'error');
            }
        }

        // Global variable for current table view
        let currentTableName = null;
        let currentTablePage = 1;

        // Load tables from selected database
        async function loadTables() {
            // Check if database is selected
            if (!selectedDatabaseId) {
                showMessage('listTablesMessage', '‚ùå Please select a database first', 'error');
                const listEl = document.getElementById('tableList');
                listEl.innerHTML = '<p style="color: rgba(254, 243, 199, 0.6); text-align: center; padding: 20px;">No database selected. Please select a database from the Dashboard.</p>';
                return;
            }
            
            // Get connection info from selected database
            const connId = selectedDatabaseId.replace('conn_', '');
            const connections = getHostingerConnections();
            const conn = connections.find(c => c.id === connId);
            
            if (!conn) {
                showMessage('listTablesMessage', '‚ùå Selected database connection not found', 'error');
                return;
            }
            
            const listEl = document.getElementById('tableList');
            listEl.innerHTML = '<div class="spinner"></div> Loading tables...';
            
            // Call API with Hostinger credentials
            const result = await apiRequest('list_tables', {
                db_host: conn.host,
                db_name: conn.dbName,
                db_user: conn.username,
                db_pass: conn.password,
                db_port: conn.port
            });
            
            if (result.success) {
                if (result.tables.length === 0) {
                    listEl.innerHTML = '<p style="color: rgba(254, 243, 199, 0.6); text-align: center; padding: 20px;">No tables found in this database</p>';
                } else {
                    listEl.innerHTML = result.tables.map(table => `
                        <div class="table-item">
                            <div class="table-name" onclick="viewTableData('${table}')" style="cursor: pointer;">
                                <span class="table-icon">üìÑ</span>
                                <span>${table}</span>
                            </div>
                            <div class="table-actions">
                                <button class="btn btn-primary" onclick="event.stopPropagation(); generateSQLFromList('${table}', false)" title="Generate CREATE TABLE only">
                                    <span>üèóÔ∏è</span> Structure
                                </button>
                                <button class="btn btn-primary" onclick="event.stopPropagation(); generateSQLFromList('${table}', true)" title="Generate CREATE TABLE + INSERT data">
                                    <span>üì¶</span> + Data
                                </button>
                            </div>
                        </div>
                    `).join('');
                }
                showMessage('listTablesMessage', `‚úÖ Found ${result.tables.length} table(s) in ${conn.name}`, 'success');
            } else {
                listEl.innerHTML = '';
                showMessage('listTablesMessage', '‚ùå ' + result.message, 'error');
            }
        }

        // View table data
        async function viewTableData(tableName, page = 1) {
            if (!selectedDatabaseId) {
                showMessage('tableDataMessage', '‚ùå No database selected', 'error');
                return;
            }

            const connId = selectedDatabaseId.replace('conn_', '');
            const connections = getHostingerConnections();
            const conn = connections.find(c => c.id === connId);
            
            if (!conn) {
                showMessage('tableDataMessage', '‚ùå Connection not found', 'error');
                return;
            }

            currentTableName = tableName;
            currentTablePage = page;

            // Show table data view, hide tables list
            document.getElementById('tablesListView').style.display = 'none';
            document.getElementById('tableDataView').style.display = 'block';
            document.getElementById('currentTableName').textContent = tableName;

            // Show loading
            document.getElementById('tableDataContainer').innerHTML = '<div style="text-align: center; padding: 40px;"><div class="spinner"></div><div style="margin-top: 15px;">Loading table data...</div></div>';
            document.getElementById('tableInfoStats').innerHTML = '';
            document.getElementById('paginationTop').innerHTML = '';
            document.getElementById('paginationBottom').innerHTML = '';

            // Fetch table data
            const result = await apiRequest('get_table_data', {
                db_host: conn.host,
                db_name: conn.dbName,
                db_user: conn.username,
                db_pass: conn.password,
                db_port: conn.port,
                table_name: tableName,
                page: page,
                limit: 50
            });

            if (result.success) {
                // Render table info stats
                renderTableStats(result.table_info, result.pagination);
                
                // Render table data
                renderTableData(result.columns, result.data);
                
                // Render pagination
                renderPagination(result.pagination);
                
                showMessage('tableDataMessage', `‚úÖ Showing ${result.pagination.showing_from} - ${result.pagination.showing_to} of ${result.pagination.total_rows} rows`, 'success');
            } else {
                document.getElementById('tableDataContainer').innerHTML = `<div style="text-align: center; padding: 40px; color: #fca5a5;">‚ùå ${result.message}</div>`;
                showMessage('tableDataMessage', `‚ùå ${result.message}`, 'error');
            }
        }

        // Render table statistics
        function renderTableStats(info, pagination) {
            const statsHtml = `
                <div class="stat-box">
                    <div class="stat-label">üìä Total Rows</div>
                    <div class="stat-value">${pagination.total_rows.toLocaleString()}</div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">‚öôÔ∏è Engine</div>
                    <div class="stat-value">${info.engine}</div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">üíæ Data Size</div>
                    <div class="stat-value">${formatBytes(info.data_length)}</div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">üî§ Collation</div>
                    <div class="stat-value" style="font-size: 12px;">${info.collation}</div>
                </div>
                ${info.created ? `
                <div class="stat-box">
                    <div class="stat-label">üìÖ Created</div>
                    <div class="stat-value" style="font-size: 12px;">${new Date(info.created).toLocaleDateString()}</div>
                </div>` : ''}
                ${info.updated ? `
                <div class="stat-box">
                    <div class="stat-label">üîÑ Updated</div>
                    <div class="stat-value" style="font-size: 12px;">${new Date(info.updated).toLocaleDateString()}</div>
                </div>` : ''}
            `;
            document.getElementById('tableInfoStats').innerHTML = statsHtml;
        }

        // Render table data
        function renderTableData(columns, data) {
            if (data.length === 0) {
                document.getElementById('tableDataContainer').innerHTML = '<div style="text-align: center; padding: 40px; color: rgba(254, 243, 199, 0.6);">üì≠ No data in this table</div>';
                return;
            }

            const tableHtml = `
                <table class="data-table">
                    <thead>
                        <tr>
                            ${columns.map(col => `<th title="${col.Type}">${col.Field}${col.Key === 'PRI' ? ' üîë' : ''}${col.Key === 'UNI' ? ' ‚≠ê' : ''}</th>`).join('')}
                        </tr>
                    </thead>
                    <tbody>
                        ${data.map(row => `
                            <tr>
                                ${columns.map(col => {
                                    const value = row[col.Field];
                                    const displayValue = value === null ? '<span style="color: #fca5a5; font-style: italic;">NULL</span>' : 
                                                       typeof value === 'string' && value.length > 100 ? value.substring(0, 100) + '...' : 
                                                       value;
                                    return `<td title="${value}">${displayValue}</td>`;
                                }).join('')}
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
            document.getElementById('tableDataContainer').innerHTML = tableHtml;
        }

        // Render pagination controls
        function renderPagination(pagination) {
            const paginationHtml = `
                <div class="pagination-info">
                    Showing <strong>${pagination.showing_from}</strong> - <strong>${pagination.showing_to}</strong> of <strong>${pagination.total_rows.toLocaleString()}</strong> rows
                    (Page <strong>${pagination.current_page}</strong> of <strong>${pagination.total_pages}</strong>)
                </div>
                <div class="pagination-buttons">
                    <button class="btn btn-secondary" onclick="viewTableData('${currentTableName}', 1)" ${pagination.current_page === 1 ? 'disabled' : ''}>
                        ‚èÆÔ∏è First
                    </button>
                    <button class="btn btn-secondary" onclick="viewTableData('${currentTableName}', ${pagination.current_page - 1})" ${pagination.current_page === 1 ? 'disabled' : ''}>
                        ‚óÄÔ∏è Prev
                    </button>
                    <input type="number" class="page-input" value="${pagination.current_page}" min="1" max="${pagination.total_pages}" onchange="viewTableData('${currentTableName}', parseInt(this.value))">
                    <button class="btn btn-secondary" onclick="viewTableData('${currentTableName}', ${pagination.current_page + 1})" ${pagination.current_page === pagination.total_pages ? 'disabled' : ''}>
                        Next ‚ñ∂Ô∏è
                    </button>
                    <button class="btn btn-secondary" onclick="viewTableData('${currentTableName}', ${pagination.total_pages})" ${pagination.current_page === pagination.total_pages ? 'disabled' : ''}>
                        Last ‚è≠Ô∏è
                    </button>
                </div>
            `;
            document.getElementById('paginationTop').innerHTML = paginationHtml;
            document.getElementById('paginationBottom').innerHTML = paginationHtml;
        }

        // Back to tables list
        function backToTablesList() {
            document.getElementById('tablesListView').style.display = 'block';
            document.getElementById('tableDataView').style.display = 'none';
            currentTableName = null;
            currentTablePage = 1;
        }

        // Format bytes helper
        function formatBytes(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return Math.round((bytes / Math.pow(k, i)) * 100) / 100 + ' ' + sizes[i];
        }

        // ========================================
        // RANDOM DATA GENERATOR
        // ========================================

        // Sample data pools for realistic generation
        const SAMPLE_DATA = {
            firstNames: ['John', 'Jane', 'Michael', 'Sarah', 'David', 'Emma', 'James', 'Emily', 'Robert', 'Lisa', 'William', 'Mary', 'Richard', 'Jennifer', 'Thomas', 'Linda', 'Charles', 'Patricia', 'Daniel', 'Elizabeth', 'Matthew', 'Susan', 'Anthony', 'Jessica', 'Donald', 'Karen', 'Mark', 'Nancy', 'Paul', 'Betty', 'Steven', 'Helen', 'Andrew', 'Sandra', 'Kenneth', 'Donna', 'Joshua', 'Carol', 'Kevin', 'Ruth', 'Brian', 'Sharon', 'George', 'Michelle', 'Edward', 'Laura', 'Ronald', 'Sarah', 'Timothy', 'Kimberly'],
            lastNames: ['Smith', 'Johnson', 'Williams', 'Brown', 'Jones', 'Garcia', 'Miller', 'Davis', 'Rodriguez', 'Martinez', 'Hernandez', 'Lopez', 'Gonzalez', 'Wilson', 'Anderson', 'Thomas', 'Taylor', 'Moore', 'Jackson', 'Martin', 'Lee', 'Thompson', 'White', 'Harris', 'Sanchez', 'Clark', 'Ramirez', 'Lewis', 'Robinson', 'Walker'],
            companies: ['TechCorp', 'DataSoft', 'CloudSys', 'WebFlow', 'AppWorks', 'NetCore', 'CodeBase', 'DevHub', 'InfoTech', 'SoftWare Inc', 'Digital Solutions', 'Smart Systems', 'Tech Innovators', 'Global Tech', 'Future Labs'],
            domains: ['gmail.com', 'yahoo.com', 'outlook.com', 'hotmail.com', 'company.com', 'business.net', 'email.com', 'mail.com'],
            cities: ['New York', 'Los Angeles', 'Chicago', 'Houston', 'Phoenix', 'Philadelphia', 'San Antonio', 'San Diego', 'Dallas', 'San Jose', 'Austin', 'Jacksonville', 'London', 'Paris', 'Tokyo', 'Berlin', 'Sydney', 'Toronto', 'Dubai', 'Singapore'],
            countries: ['USA', 'UK', 'Canada', 'Australia', 'Germany', 'France', 'Japan', 'China', 'India', 'Brazil', 'Mexico', 'Italy', 'Spain', 'South Korea', 'Netherlands'],
            statuses: ['active', 'inactive', 'pending', 'completed', 'cancelled', 'processing', 'approved', 'rejected', 'on_hold', 'verified'],
            categories: ['General', 'Technology', 'Business', 'Finance', 'Health', 'Education', 'Entertainment', 'Sports', 'News', 'Science'],
            products: ['Laptop', 'Smartphone', 'Tablet', 'Monitor', 'Keyboard', 'Mouse', 'Headphones', 'Camera', 'Printer', 'Scanner', 'Speaker', 'Router', 'Hard Drive', 'SSD', 'RAM'],
            descriptions: [
                'High quality product with excellent features',
                'Premium service for modern businesses',
                'Innovative solution for your needs',
                'Professional grade equipment',
                'Best value for money',
                'Industry leading performance',
                'Cutting-edge technology',
                'User-friendly interface',
                'Reliable and efficient',
                'Perfect for everyday use'
            ]
        };

        // Generate random data based on column name and type
        function generateRandomValue(columnName, columnType, isAutoIncrement, isPrimaryKey) {
            const colNameLower = columnName.toLowerCase();
            const typeUpper = columnType.toUpperCase();
            
            // Skip auto increment and primary key (will be auto-generated)
            if (isAutoIncrement || (isPrimaryKey && typeUpper.includes('INT'))) {
                return null; // Will be excluded from INSERT
            }
            
            // Name fields
            if (colNameLower.includes('first') && colNameLower.includes('name')) {
                return SAMPLE_DATA.firstNames[Math.floor(Math.random() * SAMPLE_DATA.firstNames.length)];
            }
            if (colNameLower.includes('last') && colNameLower.includes('name')) {
                return SAMPLE_DATA.lastNames[Math.floor(Math.random() * SAMPLE_DATA.lastNames.length)];
            }
            if (colNameLower === 'name' || colNameLower === 'username' || colNameLower === 'user_name' || colNameLower === 'full_name' || colNameLower === 'fullname') {
                const first = SAMPLE_DATA.firstNames[Math.floor(Math.random() * SAMPLE_DATA.firstNames.length)];
                const last = SAMPLE_DATA.lastNames[Math.floor(Math.random() * SAMPLE_DATA.lastNames.length)];
                return colNameLower.includes('user') ? first.toLowerCase() + last.toLowerCase() : first + ' ' + last;
            }
            
            // Email
            if (colNameLower.includes('email') || colNameLower.includes('mail')) {
                const name = SAMPLE_DATA.firstNames[Math.floor(Math.random() * SAMPLE_DATA.firstNames.length)].toLowerCase();
                const num = Math.floor(Math.random() * 999);
                const domain = SAMPLE_DATA.domains[Math.floor(Math.random() * SAMPLE_DATA.domains.length)];
                return `${name}${num}@${domain}`;
            }
            
            // Phone
            if (colNameLower.includes('phone') || colNameLower.includes('mobile') || colNameLower.includes('tel')) {
                return '+1' + Math.floor(Math.random() * 9000000000 + 1000000000);
            }
            
            // Address
            if (colNameLower.includes('address') || colNameLower.includes('street')) {
                return Math.floor(Math.random() * 9999 + 1) + ' ' + SAMPLE_DATA.lastNames[Math.floor(Math.random() * SAMPLE_DATA.lastNames.length)] + ' Street';
            }
            
            // City
            if (colNameLower.includes('city')) {
                return SAMPLE_DATA.cities[Math.floor(Math.random() * SAMPLE_DATA.cities.length)];
            }
            
            // Country
            if (colNameLower.includes('country')) {
                return SAMPLE_DATA.countries[Math.floor(Math.random() * SAMPLE_DATA.countries.length)];
            }
            
            // Company
            if (colNameLower.includes('company') || colNameLower.includes('organization')) {
                return SAMPLE_DATA.companies[Math.floor(Math.random() * SAMPLE_DATA.companies.length)];
            }
            
            // Title
            if (colNameLower.includes('title') && !colNameLower.includes('job')) {
                return 'Sample Title ' + Math.floor(Math.random() * 1000);
            }
            
            // Description
            if (colNameLower.includes('desc') || colNameLower.includes('content') || colNameLower.includes('comment') || colNameLower.includes('note')) {
                return SAMPLE_DATA.descriptions[Math.floor(Math.random() * SAMPLE_DATA.descriptions.length)];
            }
            
            // Status
            if (colNameLower.includes('status') || colNameLower === 'state') {
                return SAMPLE_DATA.statuses[Math.floor(Math.random() * SAMPLE_DATA.statuses.length)];
            }
            
            // Category
            if (colNameLower.includes('category') || colNameLower.includes('type') && !typeUpper.includes('INT')) {
                return SAMPLE_DATA.categories[Math.floor(Math.random() * SAMPLE_DATA.categories.length)];
            }
            
            // Product
            if (colNameLower.includes('product')) {
                return SAMPLE_DATA.products[Math.floor(Math.random() * SAMPLE_DATA.products.length)];
            }
            
            // Price/Amount/Cost
            if (colNameLower.includes('price') || colNameLower.includes('amount') || colNameLower.includes('cost') || colNameLower.includes('total')) {
                return (Math.random() * 999 + 1).toFixed(2);
            }
            
            // Quantity/Stock/Count
            if (colNameLower.includes('quantity') || colNameLower.includes('stock') || colNameLower.includes('count') || colNameLower.includes('qty')) {
                return Math.floor(Math.random() * 100);
            }
            
            // Age
            if (colNameLower === 'age') {
                return Math.floor(Math.random() * 60 + 18);
            }
            
            // Password/Hash
            if (colNameLower.includes('password') || colNameLower.includes('hash')) {
                return '$2y$10$' + Math.random().toString(36).substring(2, 15) + Math.random().toString(36).substring(2, 15);
            }
            
            // Token
            if (colNameLower.includes('token') || colNameLower.includes('key') && typeUpper.includes('VARCHAR')) {
                return Math.random().toString(36).substring(2) + Math.random().toString(36).substring(2);
            }
            
            // URL/Link
            if (colNameLower.includes('url') || colNameLower.includes('link') || colNameLower.includes('website')) {
                return 'https://example.com/' + Math.random().toString(36).substring(7);
            }
            
            // Slug
            if (colNameLower.includes('slug')) {
                return 'sample-slug-' + Math.floor(Math.random() * 10000);
            }
            
            // IP Address
            if (colNameLower.includes('ip')) {
                return Math.floor(Math.random() * 255) + '.' + Math.floor(Math.random() * 255) + '.' + Math.floor(Math.random() * 255) + '.' + Math.floor(Math.random() * 255);
            }
            
            // Based on data type
            if (typeUpper.includes('INT') || typeUpper.includes('INTEGER')) {
                if (typeUpper.includes('TINYINT')) {
                    return Math.floor(Math.random() * 2); // 0 or 1 for boolean
                }
                return Math.floor(Math.random() * 10000);
            }
            
            if (typeUpper.includes('DECIMAL') || typeUpper.includes('FLOAT') || typeUpper.includes('DOUBLE')) {
                return (Math.random() * 1000).toFixed(2);
            }
            
            if (typeUpper.includes('DATE')) {
                const start = new Date(2020, 0, 1);
                const end = new Date();
                const randomDate = new Date(start.getTime() + Math.random() * (end.getTime() - start.getTime()));
                return randomDate.toISOString().split('T')[0];
            }
            
            if (typeUpper.includes('DATETIME') || typeUpper.includes('TIMESTAMP')) {
                const start = new Date(2020, 0, 1);
                const end = new Date();
                const randomDate = new Date(start.getTime() + Math.random() * (end.getTime() - start.getTime()));
                return randomDate.toISOString().slice(0, 19).replace('T', ' ');
            }
            
            if (typeUpper.includes('TIME') && !typeUpper.includes('DATETIME')) {
                const h = Math.floor(Math.random() * 24).toString().padStart(2, '0');
                const m = Math.floor(Math.random() * 60).toString().padStart(2, '0');
                const s = Math.floor(Math.random() * 60).toString().padStart(2, '0');
                return `${h}:${m}:${s}`;
            }
            
            if (typeUpper.includes('BOOL')) {
                return Math.random() > 0.5 ? 1 : 0;
            }
            
            if (typeUpper.includes('TEXT') || typeUpper.includes('VARCHAR') || typeUpper.includes('CHAR')) {
                // Generic text
                if (colNameLower.includes('desc') || colNameLower.includes('content')) {
                    return 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. ' + Math.random().toString(36).substring(7);
                }
                return 'Sample ' + columnName + ' ' + Math.floor(Math.random() * 1000);
            }
            
            // Default
            return 'Data_' + Math.floor(Math.random() * 10000);
        }

        // Generate random records for table
        function generateRandomRecords(columns, count = 10) {
            const records = [];
            
            for (let i = 0; i < count; i++) {
                const record = {};
                
                columns.forEach(col => {
                    const isAutoIncrement = col.Extra && col.Extra.toLowerCase().includes('auto_increment');
                    const isPrimaryKey = col.Key === 'PRI';
                    
                    // Skip auto increment columns
                    if (isAutoIncrement) {
                        return;
                    }
                    
                    const value = generateRandomValue(col.Field, col.Type, isAutoIncrement, isPrimaryKey);
                    
                    if (value !== null) {
                        record[col.Field] = value;
                    }
                });
                
                records.push(record);
            }
            
            return records;
        }

        // Inject random records into current table
        async function injectRandomRecords() {
            if (!selectedDatabaseId || !currentTableName) {
                showMessage('tableDataMessage', '‚ùå No table selected', 'error');
                return;
            }

            const connId = selectedDatabaseId.replace('conn_', '');
            const connections = getHostingerConnections();
            const conn = connections.find(c => c.id === connId);
            
            if (!conn) {
                showMessage('tableDataMessage', '‚ùå Connection not found', 'error');
                return;
            }

            // Get table structure first
            showMessage('tableDataMessage', 'üîÑ Generating random data...', 'info');

            const structureResult = await apiRequest('get_table_structure', {
                db_host: conn.host,
                db_name: conn.dbName,
                db_user: conn.username,
                db_pass: conn.password,
                db_port: conn.port,
                table_name: currentTableName
            });

            if (!structureResult.success) {
                showMessage('tableDataMessage', `‚ùå ${structureResult.message}`, 'error');
                return;
            }

            // Generate random records
            const randomRecords = generateRandomRecords(structureResult.columns, 10);

            if (randomRecords.length === 0) {
                showMessage('tableDataMessage', '‚ùå Could not generate records (table has only auto-increment columns?)', 'error');
                return;
            }

            // Insert records
            showMessage('tableDataMessage', 'üîÑ Injecting 10 random records...', 'info');

            const result = await apiRequest('insert_random_data', {
                db_host: conn.host,
                db_name: conn.dbName,
                db_user: conn.username,
                db_pass: conn.password,
                db_port: conn.port,
                table_name: currentTableName,
                records_data: JSON.stringify(randomRecords),
                record_count: 10
            });

            if (result.success) {
                showMessage('tableDataMessage', `‚úÖ ${result.message}`, 'success');
                // Reload table data to show new records
                viewTableData(currentTableName, currentTablePage);
            } else {
                showMessage('tableDataMessage', `‚ùå ${result.message}`, 'error');
            }
        }

        // ========================================
        // SQL GENERATOR FUNCTIONS
        // ========================================

        let generatedSQL = '';

        // Generate full database SQL
        async function generateDatabaseSQL(includeCreateDB, includeData) {
            if (!selectedDatabaseId) {
                showMessage('generateDatabaseMessage', '‚ùå Please select a database from Dashboard first', 'error');
                return;
            }

            const connId = selectedDatabaseId.replace('conn_', '');
            const connections = getHostingerConnections();
            const conn = connections.find(c => c.id === connId);
            
            if (!conn) {
                showMessage('generateDatabaseMessage', '‚ùå Selected database connection not found', 'error');
                return;
            }

            // Determine generation type
            let genType = '';
            if (includeCreateDB && includeData) {
                genType = 'Complete Database Dump (CREATE DATABASE + Structure + Data)';
            } else if (includeCreateDB && !includeData) {
                genType = 'Full Database (CREATE DATABASE + Structure Only)';
            } else if (!includeCreateDB && includeData) {
                genType = 'Tables Structure + Data';
            } else {
                genType = 'Tables Structure Only';
            }

            showMessage('generateDatabaseMessage', `üîÑ Generating ${genType}...`, 'info');

            const result = await apiRequest('generate_database_sql', {
                db_host: conn.host,
                db_name: conn.dbName,
                db_user: conn.username,
                db_pass: conn.password,
                db_port: conn.port,
                include_create_db: includeCreateDB ? 'true' : 'false',
                include_data: includeData ? 'true' : 'false'
            });

            if (result.success) {
                generatedSQL = result.sql;
                showDatabaseSQLModal(result);
                showMessage('generateDatabaseMessage', `‚úÖ ${genType} generated successfully!`, 'success');
            } else {
                showMessage('generateDatabaseMessage', `‚ùå ${result.message}`, 'error');
            }
        }

        // Show database SQL modal
        function showDatabaseSQLModal(result) {
            document.getElementById('sqlTableName').textContent = `Database: ${result.database_name}`;
            document.getElementById('sqlCode').value = result.sql;
            
            // Show info
            let typeLabel = '';
            if (result.has_create_db && result.has_data) {
                typeLabel = 'üíé Complete Dump (DB + Tables + Data)';
            } else if (result.has_create_db && !result.has_data) {
                typeLabel = 'üóÑÔ∏è Full Database (DB + Tables)';
            } else if (!result.has_create_db && result.has_data) {
                typeLabel = 'üì¶ Tables + Data';
            } else {
                typeLabel = 'üèóÔ∏è Tables Structure Only';
            }

            const infoHtml = `
                <div class="stat-box" style="flex: 1; min-width: 150px;">
                    <div class="stat-label">üìù Generation Type</div>
                    <div class="stat-value" style="font-size: 12px;">${typeLabel}</div>
                </div>
                <div class="stat-box" style="flex: 1; min-width: 150px;">
                    <div class="stat-label">üìä Total Tables</div>
                    <div class="stat-value" style="font-size: 14px;">${result.total_tables}</div>
                </div>
                ${result.has_data ? `
                <div class="stat-box" style="flex: 1; min-width: 150px;">
                    <div class="stat-label">üìà Total Rows</div>
                    <div class="stat-value" style="font-size: 14px;">${result.total_rows.toLocaleString()}</div>
                </div>` : ''}
                <div class="stat-box" style="flex: 1; min-width: 150px;">
                    <div class="stat-label">üìè SQL Size</div>
                    <div class="stat-value" style="font-size: 14px;">${formatBytes(result.sql_length)}</div>
                </div>
            `;
            document.getElementById('sqlInfo').innerHTML = infoHtml;
            
            // Show success message
            const messageHtml = `
                <div class="message success" style="display: block;">
                    ‚úÖ Database SQL generated successfully! Ready to copy or download.
                </div>
            `;
            document.getElementById('sqlMessage').innerHTML = messageHtml;
            
            document.getElementById('sqlModal').classList.add('active');
        }

        // Generate SQL from table list (when clicking buttons on table cards)
        async function generateSQLFromList(tableName, includeData) {
            if (!selectedDatabaseId) {
                alert('‚ùå No database selected');
                return;
            }

            const connId = selectedDatabaseId.replace('conn_', '');
            const connections = getHostingerConnections();
            const conn = connections.find(c => c.id === connId);
            
            if (!conn) {
                alert('‚ùå Connection not found');
                return;
            }

            // Show loading message
            showMessage('listTablesMessage', `üîÑ Generating SQL for ${tableName} ${includeData ? 'with data' : 'structure only'}...`, 'info');

            const result = await apiRequest('generate_table_sql', {
                db_host: conn.host,
                db_name: conn.dbName,
                db_user: conn.username,
                db_pass: conn.password,
                db_port: conn.port,
                table_name: tableName,
                include_data: includeData ? 'true' : 'false'
            });

            if (result.success) {
                generatedSQL = result.sql;
                showSQLModal(result);
                showMessage('listTablesMessage', `‚úÖ SQL generated successfully for ${tableName}!`, 'success');
            } else {
                showMessage('listTablesMessage', `‚ùå ${result.message}`, 'error');
            }
        }

        // Generate SQL for table (from table data view)
        async function generateSQL(includeData) {
            if (!selectedDatabaseId || !currentTableName) {
                alert('‚ùå No table selected');
                return;
            }

            const connId = selectedDatabaseId.replace('conn_', '');
            const connections = getHostingerConnections();
            const conn = connections.find(c => c.id === connId);
            
            if (!conn) {
                alert('‚ùå Connection not found');
                return;
            }

            // Show loading message
            showMessage('tableDataMessage', `üîÑ Generating SQL ${includeData ? 'with data' : 'structure only'}...`, 'info');

            const result = await apiRequest('generate_table_sql', {
                db_host: conn.host,
                db_name: conn.dbName,
                db_user: conn.username,
                db_pass: conn.password,
                db_port: conn.port,
                table_name: currentTableName,
                include_data: includeData ? 'true' : 'false'
            });

            if (result.success) {
                generatedSQL = result.sql;
                showSQLModal(result);
                showMessage('tableDataMessage', `‚úÖ SQL generated successfully!`, 'success');
            } else {
                showMessage('tableDataMessage', `‚ùå ${result.message}`, 'error');
            }
        }

        // Show SQL modal
        function showSQLModal(result) {
            document.getElementById('sqlTableName').textContent = result.table_name;
            document.getElementById('sqlCode').value = result.sql;
            
            // Show info
            const infoHtml = `
                <div class="stat-box" style="flex: 1; min-width: 150px;">
                    <div class="stat-label">${result.has_data ? 'üì¶ Structure + Data' : 'üèóÔ∏è Structure Only'}</div>
                    <div class="stat-value" style="font-size: 14px;">${result.has_data ? result.row_count + ' rows' : 'No data'}</div>
                </div>
                <div class="stat-box" style="flex: 1; min-width: 150px;">
                    <div class="stat-label">üìè SQL Size</div>
                    <div class="stat-value" style="font-size: 14px;">${formatBytes(result.sql_length)}</div>
                </div>
            `;
            document.getElementById('sqlInfo').innerHTML = infoHtml;
            
            // Show success message
            const messageHtml = `
                <div class="message success" style="display: block;">
                    ‚úÖ SQL generated successfully! You can now copy or download it.
                </div>
            `;
            document.getElementById('sqlMessage').innerHTML = messageHtml;
            
            document.getElementById('sqlModal').classList.add('active');
        }

        // Close SQL modal
        function closeSQLModal() {
            document.getElementById('sqlModal').classList.remove('active');
            generatedSQL = '';
        }

        // Copy SQL to clipboard
        async function copySQLToClipboard() {
            const sqlCode = document.getElementById('sqlCode').value;
            
            try {
                await navigator.clipboard.writeText(sqlCode);
                
                // Visual feedback in modal
                const messageEl = document.getElementById('sqlMessage');
                messageEl.innerHTML = '<div class="message success" style="display: block;">‚úÖ SQL copied to clipboard successfully!</div>';
                
                setTimeout(() => {
                    messageEl.innerHTML = '<div class="message success" style="display: block;">‚úÖ SQL generated successfully! You can now copy or download it.</div>';
                }, 2000);

                // Show message in appropriate location
                const currentView = document.getElementById('tableDataView').style.display;
                if (currentView === 'none') {
                    showMessage('generateDatabaseMessage', '‚úÖ SQL copied to clipboard!', 'success');
                } else {
                    showMessage('tableDataMessage', '‚úÖ SQL copied to clipboard!', 'success');
                }
            } catch (err) {
                // Fallback for older browsers
                const textarea = document.getElementById('sqlCode');
                textarea.select();
                document.execCommand('copy');
                
                const currentView = document.getElementById('tableDataView').style.display;
                if (currentView === 'none') {
                    showMessage('generateDatabaseMessage', '‚úÖ SQL copied to clipboard!', 'success');
                } else {
                    showMessage('tableDataMessage', '‚úÖ SQL copied to clipboard!', 'success');
                }
            }
        }

        // Download SQL file
        function downloadSQL() {
            const sqlCode = document.getElementById('sqlCode').value;
            const nameText = document.getElementById('sqlTableName').textContent;
            const timestamp = new Date().toISOString().replace(/[:.]/g, '-').slice(0, -5);
            
            // Clean filename (remove special chars)
            const cleanName = nameText.replace(/[^a-zA-Z0-9_-]/g, '_').replace(/_{2,}/g, '_');
            const filename = `${cleanName}_${timestamp}.sql`;
            
            const blob = new Blob([sqlCode], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            // Show message in appropriate location
            const currentView = document.getElementById('tableDataView').style.display;
            if (currentView === 'none') {
                showMessage('generateDatabaseMessage', `‚úÖ SQL file downloaded: ${filename}`, 'success');
            } else {
                showMessage('tableDataMessage', `‚úÖ SQL file downloaded: ${filename}`, 'success');
            }
        }

        // Load tables for dropdowns
        async function loadTablesForDropdowns() {
            if (!selectedDatabaseId) return;

            const connId = selectedDatabaseId.replace('conn_', '');
            const connections = getHostingerConnections();
            const conn = connections.find(c => c.id === connId);
            
            if (!conn) return;
            
            const result = await apiRequest('list_tables', {
                db_host: conn.host,
                db_name: conn.dbName,
                db_user: conn.username,
                db_pass: conn.password,
                db_port: conn.port
            });
            
            if (result.success) {
                const options = result.tables.map(table => 
                    `<option value="${table}">${table}</option>`
                ).join('');
                
                document.getElementById('editTableSelect').innerHTML = '<option value="">-- Select Table --</option>' + options;
                document.getElementById('deleteTableSelect').innerHTML = '<option value="">-- Select Table --</option>' + options;
                document.getElementById('renameTableOldSelect').innerHTML = '<option value="">-- Select Table --</option>' + options;
            }
        }

        // Delete table
        async function deleteTableAction(event) {
            event.preventDefault();
            
            if (!selectedDatabaseId) {
                showMessage('deleteTableMessage', '‚ùå Please select a database from Dashboard first', 'error');
                return;
            }

            const connId = selectedDatabaseId.replace('conn_', '');
            const connections = getHostingerConnections();
            const conn = connections.find(c => c.id === connId);
            
            if (!conn) {
                showMessage('deleteTableMessage', '‚ùå Connection not found', 'error');
                return;
            }
            
            const tableName = document.getElementById('deleteTableSelect').value;
            
            if (!tableName) {
                showMessage('deleteTableMessage', '‚ùå Please select a table', 'error');
                return;
            }
            
            if (!confirm(`Are you sure you want to delete the table "${tableName}"?\n\nThis action cannot be undone!`)) {
                return;
            }
            
            showMessage('deleteTableMessage', 'üîÑ Deleting table...', 'info');
            
            const result = await apiRequest('delete_table', {
                db_host: conn.host,
                db_name: conn.dbName,
                db_user: conn.username,
                db_pass: conn.password,
                db_port: conn.port,
                table_name: tableName
            });
            
            if (result.success) {
                showMessage('deleteTableMessage', `‚úÖ ${result.message}`, 'success');
                document.getElementById('deleteTableSelect').value = '';
                loadTablesForDropdowns();
                // Refresh table list if we're in that section
                if (document.getElementById('listTables').classList.contains('active')) {
                    loadTables();
                }
            } else {
                showMessage('deleteTableMessage', `‚ùå ${result.message}`, 'error');
            }
        }

        // Rename table
        async function renameTableAction(event) {
            event.preventDefault();
            
            if (!selectedDatabaseId) {
                showMessage('renameTableMessage', '‚ùå Please select a database from Dashboard first', 'error');
                return;
            }

            const connId = selectedDatabaseId.replace('conn_', '');
            const connections = getHostingerConnections();
            const conn = connections.find(c => c.id === connId);
            
            if (!conn) {
                showMessage('renameTableMessage', '‚ùå Connection not found', 'error');
                return;
            }
            
            const oldName = document.getElementById('renameTableOldSelect').value;
            const newName = document.getElementById('renameTableNewName').value.trim();
            
            if (!oldName || !newName) {
                showMessage('renameTableMessage', '‚ùå Please provide both old and new table names', 'error');
                return;
            }
            
            if (oldName === newName) {
                showMessage('renameTableMessage', '‚ùå New name must be different from old name', 'error');
                return;
            }
            
            showMessage('renameTableMessage', 'üîÑ Renaming table...', 'info');
            
            const result = await apiRequest('rename_table', {
                db_host: conn.host,
                db_name: conn.dbName,
                db_user: conn.username,
                db_pass: conn.password,
                db_port: conn.port,
                old_table_name: oldName,
                new_table_name: newName
            });
            
            if (result.success) {
                showMessage('renameTableMessage', `‚úÖ ${result.message}`, 'success');
                document.getElementById('renameTableOldSelect').value = '';
                document.getElementById('renameTableNewName').value = '';
                loadTablesForDropdowns();
                // Refresh table list if we're in that section
                if (document.getElementById('listTables').classList.contains('active')) {
                    loadTables();
                }
            } else {
                showMessage('renameTableMessage', `‚ùå ${result.message}`, 'error');
            }
        }

        // Load table structure for editing
        async function loadTableStructure() {
            const tableName = document.getElementById('editTableSelect').value;
            
            if (!tableName || !selectedDatabaseId) {
                document.getElementById('currentStructure').style.display = 'none';
                return;
            }

            const connId = selectedDatabaseId.replace('conn_', '');
            const connections = getHostingerConnections();
            const conn = connections.find(c => c.id === connId);
            
            if (!conn) {
                showMessage('editTableMessage', '‚ùå Connection not found', 'error');
                return;
            }
            
            const result = await apiRequest('get_table_structure', {
                db_host: conn.host,
                db_name: conn.dbName,
                db_user: conn.username,
                db_pass: conn.password,
                db_port: conn.port,
                table_name: tableName
            });
            
            if (result.success) {
                const container = document.getElementById('currentColumns');
                container.innerHTML = result.columns.map(col => `
                    <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 8px; margin-bottom: 10px;">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <strong style="color: #fbbf24;">${col.Field}</strong>
                                <span style="color: rgba(254,243,199,0.7); margin-left: 15px;">${col.Type}</span>
                                ${col.Null === 'NO' ? '<span style="color: #ef4444; margin-left: 10px;">NOT NULL</span>' : ''}
                                ${col.Key === 'PRI' ? '<span style="color: #fbbf24; margin-left: 10px;">PRIMARY KEY</span>' : ''}
                                ${col.Key === 'UNI' ? '<span style="color: #3b82f6; margin-left: 10px;">UNIQUE</span>' : ''}
                                ${col.Extra ? `<span style="color: #86efac; margin-left: 10px;">${col.Extra}</span>` : ''}
                            </div>
                            <button type="button" class="btn btn-danger btn-icon" onclick="dropColumn('${tableName}', '${col.Field}')">√ó</button>
                        </div>
                        ${col.Default !== null ? `<div style="color: rgba(254,243,199,0.6); margin-top: 5px; font-size: 12px;">Default: ${col.Default}</div>` : ''}
                    </div>
                `).join('');
                
                document.getElementById('currentStructure').style.display = 'block';
                showMessage('editTableMessage', `‚úÖ Loaded structure for table: ${tableName}`, 'success');
            } else {
                showMessage('editTableMessage', '‚ùå ' + result.message, 'error');
            }
        }

        // Add column to existing table
        async function addColumn() {
            const tableName = document.getElementById('editTableSelect').value;
            
            if (!tableName || !selectedDatabaseId) {
                showMessage('editTableMessage', '‚ùå Please select a table first', 'error');
                return;
            }

            const connId = selectedDatabaseId.replace('conn_', '');
            const connections = getHostingerConnections();
            const conn = connections.find(c => c.id === connId);
            
            if (!conn) {
                showMessage('editTableMessage', '‚ùå Connection not found', 'error');
                return;
            }
            
            const columnData = {
                name: document.getElementById('newColName').value.trim(),
                type: document.getElementById('newColType').value,
                length: document.getElementById('newColLength').value.trim(),
                nullable: document.getElementById('newColNullable').value,
                defaultValue: document.getElementById('newColDefault').value.trim()
            };
            
            if (!columnData.name) {
                showMessage('editTableMessage', '‚ùå Please enter a column name', 'error');
                return;
            }
            
            showMessage('editTableMessage', 'üîÑ Adding column...', 'info');
            
            const result = await apiRequest('alter_table', {
                db_host: conn.host,
                db_name: conn.dbName,
                db_user: conn.username,
                db_pass: conn.password,
                db_port: conn.port,
                table_name: tableName,
                alter_action: 'add',
                column_data: JSON.stringify(columnData)
            });
            
            if (result.success) {
                showMessage('editTableMessage', `‚úÖ ${result.message}`, 'success');
                document.getElementById('newColName').value = '';
                document.getElementById('newColLength').value = '';
                document.getElementById('newColDefault').value = '';
                loadTableStructure();
            } else {
                showMessage('editTableMessage', `‚ùå ${result.message}`, 'error');
            }
        }

        // Drop column from table
        async function dropColumn(tableName, columnName) {
            if (!confirm(`Are you sure you want to drop column "${columnName}" from table "${tableName}"?\n\nThis action cannot be undone!`)) {
                return;
            }

            if (!selectedDatabaseId) {
                showMessage('editTableMessage', '‚ùå No database selected', 'error');
                return;
            }

            const connId = selectedDatabaseId.replace('conn_', '');
            const connections = getHostingerConnections();
            const conn = connections.find(c => c.id === connId);
            
            if (!conn) {
                showMessage('editTableMessage', '‚ùå Connection not found', 'error');
                return;
            }
            
            showMessage('editTableMessage', 'üîÑ Dropping column...', 'info');
            
            const result = await apiRequest('alter_table', {
                db_host: conn.host,
                db_name: conn.dbName,
                db_user: conn.username,
                db_pass: conn.password,
                db_port: conn.port,
                table_name: tableName,
                alter_action: 'drop',
                column_data: JSON.stringify({ name: columnName })
            });
            
            if (result.success) {
                showMessage('editTableMessage', `‚úÖ ${result.message}`, 'success');
                loadTableStructure();
            } else {
                showMessage('editTableMessage', `‚ùå ${result.message}`, 'error');
            }
        }

        // Initialize column builder on page load
        document.addEventListener('DOMContentLoaded', function() {
            // Add initial column row
            addColumnRow();
        });

        // ========================================
        // EXPORT/IMPORT CONNECTIONS FUNCTIONS
        // ========================================

        const PREFERRED_EXPORT_PATH_KEY = 'preferred_export_path';

        // Export connections to file (Direct Download)
        async function exportConnectionsToFile() {
            const connections = getHostingerConnections();
            
            if (connections.length === 0) {
                showMessage('settingsMessage', '‚ùå No connections to export', 'error');
                return;
            }

            showMessage('settingsMessage', 'üîÑ Preparing export...', 'info');

            // Create export data
            const exportData = {
                exported_at: new Date().toLocaleString(),
                total_connections: connections.length,
                connections: connections
            };

            // Generate filename with timestamp
            const timestamp = new Date().toISOString().replace(/[:.]/g, '-').slice(0, -5);
            const filename = `hostinger_connections_${timestamp}.json`;
            
            // Convert to JSON
            const jsonData = JSON.stringify(exportData, null, 2);
            const blob = new Blob([jsonData], { type: 'application/json' });

            // Check if File System Access API is supported
            if ('showSaveFilePicker' in window) {
                try {
                    // Get preferred directory from localStorage
                    const preferredPath = localStorage.getItem(PREFERRED_EXPORT_PATH_KEY);
                    
                    const options = {
                        suggestedName: filename,
                        types: [{
                            description: 'JSON Files',
                            accept: { 'application/json': ['.json'] }
                        }]
                    };

                    // Show file picker
                    const fileHandle = await window.showSaveFilePicker(options);
                    
                    // Write file
                    const writable = await fileHandle.createWritable();
                    await writable.write(blob);
                    await writable.close();

                    // Save the directory path for next time (if possible)
                    try {
                        const dirHandle = await fileHandle.getParent?.();
                        if (dirHandle) {
                            localStorage.setItem(PREFERRED_EXPORT_PATH_KEY, dirHandle.name);
                        }
                    } catch (e) {
                        // Ignore if getParent is not supported
                    }

                    showMessage('settingsMessage', 
                        `‚úÖ Connections exported successfully!\nüìÅ File: ${filename}\nüìä Total: ${connections.length} connections`, 
                        'success'
                    );
                } catch (error) {
                    if (error.name !== 'AbortError') {
                        // Fallback to download if user didn't cancel
                        downloadFile(blob, filename);
                        showMessage('settingsMessage', 
                            `‚úÖ Export started! Check your downloads folder.\nüìÅ File: ${filename}\nüìä Total: ${connections.length} connections`, 
                            'success'
                        );
                    }
                }
            } else {
                // Fallback: Direct download
                downloadFile(blob, filename);
                showMessage('settingsMessage', 
                    `‚úÖ Export started! Check your downloads folder.\nüìÅ File: ${filename}\nüìä Total: ${connections.length} connections`, 
                    'success'
                );
            }
        }

        // Helper function to download file
        function downloadFile(blob, filename) {
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // Import connections using File Picker
        async function showImportModal() {
            // Check if File System Access API is supported
            if ('showOpenFilePicker' in window) {
                importConnectionsWithFilePicker();
            } else {
                // Fallback: Use hidden input file
                importConnectionsWithInputFile();
            }
        }

        // Import using File System Access API
        async function importConnectionsWithFilePicker() {
            try {
                const options = {
                    types: [{
                        description: 'JSON Files',
                        accept: { 'application/json': ['.json'] }
                    }],
                    multiple: false
                };

                showMessage('settingsMessage', 'üìÇ Opening file picker...', 'info');

                const [fileHandle] = await window.showOpenFilePicker(options);
                const file = await fileHandle.getFile();
                
                await processImportFile(file);
            } catch (error) {
                if (error.name !== 'AbortError') {
                    showMessage('settingsMessage', `‚ùå Error: ${error.message}`, 'error');
                }
            }
        }

        // Import using traditional input file (fallback)
        function importConnectionsWithInputFile() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json,application/json';
            
            input.onchange = async (e) => {
                const file = e.target.files[0];
                if (file) {
                    await processImportFile(file);
                }
            };
            
            input.click();
        }

        // Process the imported file
        async function processImportFile(file) {
            try {
                showMessage('settingsMessage', `üîÑ Reading file: ${file.name}...`, 'info');

                const text = await file.text();
                const importData = JSON.parse(text);

                // Validate structure
                if (!importData.connections || !Array.isArray(importData.connections)) {
                    showMessage('settingsMessage', '‚ùå Invalid file format. Expected connections array.', 'error');
                    return;
                }

                // Confirm import
                if (!confirm(`Import ${importData.connections.length} connections from:\n${file.name}\n\nThis will MERGE with your existing connections. Continue?`)) {
                    return;
                }

                showMessage('settingsMessage', 'üîÑ Importing connections...', 'info');

                // Get current connections
                let currentConnections = getHostingerConnections();
                const importedConnections = importData.connections;

                // Merge strategy: Update existing by ID or add new
                let updatedCount = 0;
                let addedCount = 0;

                importedConnections.forEach(imported => {
                    const existingIndex = currentConnections.findIndex(c => c.id === imported.id);
                    if (existingIndex !== -1) {
                        // Update existing
                        currentConnections[existingIndex] = imported;
                        updatedCount++;
                    } else {
                        // Add new
                        currentConnections.push(imported);
                        addedCount++;
                    }
                });

                // Save merged connections
                saveHostingerConnections(currentConnections);

                // Refresh UI
                loadHostingerConnectionsTable();
                loadDashboardConnections();

                showMessage('settingsMessage', 
                    `‚úÖ Import successful!\nüìä Total: ${importData.connections.length}\n‚úèÔ∏è Updated: ${updatedCount}\n‚ûï Added: ${addedCount}\nüìÖ Exported: ${importData.exported_at || 'Unknown'}`, 
                    'success'
                );
            } catch (error) {
                showMessage('settingsMessage', `‚ùå Import failed: ${error.message}`, 'error');
            }
        }

        // Close import modal (not needed anymore but keeping for compatibility)
        function closeImportModal() {
            const modal = document.getElementById('importModal');
            if (modal) {
                modal.classList.remove('active');
            }
        }
    </script>
</body>
</html>
